<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Lefthook Documentation</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Lefthook Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/evilmartians/lefthook" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p><img align="right" width="147" height="125" title="Lefthook logo"
     src="./favicon.svg"></p>
<p><strong>Lefthook</strong> is a Git hooks manager. This documentation provides the reference for installing, configuring and using the lefthook.</p>
<ul>
<li>
<p><strong><a href="./installation">Installation instructions</a></strong> to install lefthook to your OS or project.</p>
</li>
<li>
<p><strong><a href="./examples">Examples</a></strong> of lefthook common usage.</p>
</li>
<li>
<p><strong><a href="./configuration">Configuration</a></strong> with detailed explanation of lefthook options.</p>
</li>
</ul>
<p><strong>Example:</strong> Run your linters on <code>pre-commit</code> hook and forget about the routine.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  parallel: true
  jobs:
    - run: yarn run stylelint --fix {staged_files}
      glob: "*.css"
      stage_fixed: true

    - run: yarn run eslint --fix "{staged_files}"
      glob:
        - "*.ts"
        - "*.js"
        - "*.tsx"
        - "*.jsx"
      stage_fixed: true
</code></pre>
<hr />
<a href="https://evilmartians.com/?utm_source=lefthook">
<img src="https://evilmartians.com/badges/sponsored-by-evil-martians.svg" alt="Sponsored by Evil Martians" width="100%" height="54"></a>
<p>‚ùì<em>If you have a question or found a mistake in the documentation, please create a new <a href="https://github.com/evilmartians/lefthook/discussions/new/choose">discussion</a>. Small contributions help maintaining the quality of the project.</em></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="install-lefthook"><a class="header" href="#install-lefthook">Install lefthook</a></h1>
<p>Choose your fighter:</p>
<ul>
<li><a href="installation/./ruby.html">Ruby</a></li>
<li><a href="installation/./node.html">Node.js</a></li>
<li><a href="installation/./go.html">Go</a></li>
<li><a href="installation/./python.html">Python</a></li>
<li><a href="installation/./swift.html">Swift</a></li>
<li><a href="installation/./scoop.html">Scoop</a></li>
<li><a href="installation/./homebrew.html">Homebrew</a></li>
<li><a href="installation/./winget.html">Winget</a></li>
<li><a href="installation/./snap.html">Snap</a></li>
<li><a href="installation/./deb.html">Debian-based distro</a></li>
<li><a href="installation/./rpm.html">RPM-based distro</a></li>
<li><a href="installation/./alpine.html">Alpine</a></li>
<li><a href="installation/./arch.html">Arch Linux</a></li>
<li><a href="installation/./manual.html">Manual</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="ruby"><a class="header" href="#ruby">Ruby</a></h2>
<pre><code class="language-bash">gem install lefthook
</code></pre>
<p><strong>Troubleshooting</strong></p>
<p>If you see the error <code>lefthook: command not found</code> you need to check your $PATH. Also try to restart your terminal.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="nodejs"><a class="header" href="#nodejs">Node.js</a></h2>
<p>Lefthook is available on NPM in the following flavors:</p>
<ol>
<li>
<p><a href="https://www.npmjs.com/package/lefthook">lefthook</a> that will install the proper binary:</p>
<pre><code class="language-bash">npm install lefthook --save-dev
# or yarn:
yarn add -D lefthook
</code></pre>
</li>
<li>
<p><a href="https://www.npmjs.com/package/@evilmartians/lefthook">@evilmartians/lefthook</a> with pre-bundled binaries for all architectures:</p>
<pre><code class="language-bash">npm install @evilmartians/lefthook --save-dev
# or yarn:
yarn add -D @evilmartians/lefthook
</code></pre>
</li>
<li>
<p><a href="https://www.npmjs.com/package/@evilmartians/lefthook-installer">@evilmartians/lefthook-installer</a> that will fetch binary file on installation:</p>
<pre><code class="language-bash">npm install @evilmartians/lefthook-installer --save-dev
# or yarn:
yarn add -D @evilmartians/lefthook-installer
</code></pre>
</li>
</ol>
<blockquote>
<p><strong>Note:</strong> If you use <code>pnpm</code> package manager make sure you set <code>side-effects-cache = false</code> in your .npmrc, otherwise the postinstall script of the lefthook package won't be executed and hooks won't be installed.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="go"><a class="header" href="#go">Go</a></h2>
<pre><code class="language-bash">go install github.com/evilmartians/lefthook@latest
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="python"><a class="header" href="#python">Python</a></h2>
<pre><code class="language-sh">python -m pip install --user lefthook
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="swift"><a class="header" href="#swift">Swift</a></h2>
<p>You can find the Swift wrapper plugin <a href="https://github.com/csjones/lefthook-plugin">here</a>.</p>
<p>Utilize lefthook in your Swift project using Swift Package Manager:</p>
<pre><code class="language-swift">.package(url: "https://github.com/csjones/lefthook-plugin.git", exact: "1.10.10"),
</code></pre>
<p>Or, with <a href="https://github.com/yonaskolb/Mint">mint</a>:</p>
<pre><code class="language-bash">mint run csjones/lefthook-plugin
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="scoop-for-windows"><a class="header" href="#scoop-for-windows">Scoop for Windows</a></h2>
<pre><code class="language-sh">scoop install lefthook
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="homebrew-for-macos-and-linux"><a class="header" href="#homebrew-for-macos-and-linux">Homebrew for MacOS and Linux</a></h2>
<pre><code class="language-bash">brew install lefthook
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="winget-for-windows"><a class="header" href="#winget-for-windows">Winget for Windows</a></h2>
<pre><code class="language-sh">winget install evilmartians.lefthook
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="snap-for-linux"><a class="header" href="#snap-for-linux">Snap for Linux</a></h2>
<pre><code class="language-sh">snap install --classic lefthook
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="apt-packages-for-debianubuntu-linux"><a class="header" href="#apt-packages-for-debianubuntu-linux">APT packages for Debian/Ubuntu Linux</a></h2>
<pre><code class="language-sh">curl -1sLf 'https://dl.cloudsmith.io/public/evilmartians/lefthook/setup.deb.sh' | sudo -E bash
sudo apt install lefthook
</code></pre>
<p>See all instructions: https://cloudsmith.io/~evilmartians/repos/lefthook/setup/#formats-deb</p>
<p><a href="https://cloudsmith.com" title="Debian package repository hosting is graciously provided by Cloudsmith"><img src="https://img.shields.io/badge/OSS%20hosting%20by-cloudsmith-blue?logo=cloudsmith&amp;style=flat-square" alt="Hosted By: Cloudsmith" /></a></p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="rpm-packages-for-centosfedora-linux"><a class="header" href="#rpm-packages-for-centosfedora-linux">RPM packages for CentOS/Fedora Linux</a></h2>
<pre><code class="language-sh">curl -1sLf 'https://dl.cloudsmith.io/public/evilmartians/lefthook/setup.rpm.sh' | sudo -E bash
sudo yum install lefthook
</code></pre>
<p>See all instructions: https://cloudsmith.io/~evilmartians/repos/lefthook/setup/#repository-setup-yum</p>
<p><a href="https://cloudsmith.com" title="RPM package repository hosting is graciously provided by Cloudsmith"><img src="https://img.shields.io/badge/OSS%20hosting%20by-cloudsmith-blue?logo=cloudsmith&amp;style=flat-square" alt="Hosted By: Cloudsmith" /></a></p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="apk-packages-for-alpine"><a class="header" href="#apk-packages-for-alpine">APK packages for Alpine</a></h2>
<pre><code class="language-sh">sudo apk add --no-cache bash curl
curl -1sLf 'https://dl.cloudsmith.io/public/evilmartians/lefthook/setup.alpine.sh' | sudo -E bash
sudo apk add lefthook
</code></pre>
<p>See all instructions: https://cloudsmith.io/~evilmartians/repos/lefthook/setup/#formats-alpine</p>
<p><a href="https://cloudsmith.com" title="RPM package repository hosting is graciously provided by Cloudsmith"><img src="https://img.shields.io/badge/OSS%20hosting%20by-cloudsmith-blue?logo=cloudsmith&amp;style=flat-square" alt="Hosted By: Cloudsmith" /></a></p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="aur-for-arch"><a class="header" href="#aur-for-arch">AUR for Arch</a></h2>
<ul>
<li>Official <a href="https://aur.archlinux.org/packages/lefthook">AUR package</a> (compiles from sources)</li>
<li>Community <a href="https://aur.archlinux.org/packages/lefthook-bin">AUR package</a> (delivers pre-compiled binaries)</li>
</ul>
<pre><code class="language-sh"># To compile from sources
yay -S lefthook

# To install only executable
yay -S lefthook-bin
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="manuall-installation-with-prebuilt-executable"><a class="header" href="#manuall-installation-with-prebuilt-executable">Manuall installation with prebuilt executable</a></h2>
<p>Download from <a href="https://github.com/evilmartians/lefthook/releases">binaries</a> and install manually.</p>
<ol>
<li>Download the executable for your OS and Arch</li>
<li>Put the executable under the $PATH (for unix systems)</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="usage"><a class="header" href="#usage">Usage</a></h1>
<ul>
<li><a href="usage/./commands.html">Commands</a>
<ul>
<li><a href="usage/./commands.html#lefthook-install"><code>lefthook install</code></a></li>
<li><a href="usage/./commands.html#lefthook-uninstall"><code>lefthook uninstall</code></a></li>
<li><a href="usage/./commands.html#lefthook-add"><code>lefthook add</code></a></li>
<li><a href="usage/./commands.html#lefthook-run"><code>lefthook run</code></a></li>
<li><a href="usage/./commands.html#lefthook-version"><code>lefthook version</code></a></li>
<li><a href="usage/./commands.html#lefthook-self-update"><code>lefthook self-update</code></a></li>
<li><a href="usage/./commands.html#lefthook-validate"><code>lefthook validate</code></a></li>
<li><a href="usage/./commands.html#lefthook-dump"><code>lefthook dump</code></a></li>
</ul>
</li>
<li><a href="usage/./env.html">ENV variables</a>
<ul>
<li><a href="usage/./env.html#lefthook"><code>LEFTHOOK</code></a></li>
<li><a href="usage/./env.html#lefthook_exclude"><code>LEFTHOOK_EXCLUDE</code></a></li>
<li><a href="usage/./env.html#lefthook_output"><code>LEFTHOOK_OUTPUT</code></a></li>
<li><a href="usage/./env.html#lefthook_quiet"><code>LEFTHOOK_QUIET</code></a></li>
<li><a href="usage/./env.html#lefthook_verbose"><code>LEFTHOOK_VERBOSE</code></a></li>
<li><a href="usage/./env.html#lefthook_bin"><code>LEFTHOOK_BIN</code></a></li>
<li><a href="usage/./env.html#no_color"><code>NO_COLOR</code></a></li>
<li><a href="usage/./env.html#clicolor_force"><code>CLICOLOR_FORCE</code></a></li>
</ul>
</li>
<li><a href="usage/./tips.html">Tips</a>
<ul>
<li><a href="usage/./tips.html#local-config">Local config</a></li>
<li><a href="usage/./tips.html#disable-lefthook-in-ci">Disable lefthook in CI</a></li>
<li><a href="usage/./tips.html#commitlint-example">Commitlint example</a></li>
<li><a href="usage/./tips.html#parallel-execution">Parallel execution</a></li>
<li><a href="usage/./tips.html#concurrent-files-overrides">Concurrent files overrides</a></li>
<li><a href="usage/./tips.html#capture-args-from-git-in-the-script">Capture ARGS from git in the script</a></li>
<li><a href="usage/./tips.html#git-lfs-support">Git LFS support</a></li>
<li><a href="usage/./tips.html#pass-stdin-to-a-command-or-script">Pass stdin to a command or script</a></li>
<li><a href="usage/./tips.html#using-an-interactive-command-or-script">Using an interactive command or script</a></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="commands"><a class="header" href="#commands">Commands</a></h2>
<blockquote>
<p><strong>Tip:</strong> Use <code>lefthook help</code> or <code>lefthook &lt;command&gt; -h/--help</code> to discover available commands and their options</p>
</blockquote>
<ul>
<li><a href="usage/commands.html#lefthook-install"><code>lefthook install</code></a></li>
<li><a href="usage/commands.html#lefthook-uninstall"><code>lefthook uninstall</code></a></li>
<li><a href="usage/commands.html#lefthook-add"><code>lefthook add</code></a></li>
<li><a href="usage/commands.html#lefthook-run"><code>lefthook run</code></a></li>
<li><a href="usage/commands.html#lefthook-version"><code>lefthook version</code></a></li>
<li><a href="usage/commands.html#lefthook-self-update"><code>lefthook self-update</code></a></li>
<li><a href="usage/commands.html#lefthook-validate"><code>lefthook validate</code></a></li>
<li><a href="usage/commands.html#lefthook-dump"><code>lefthook dump</code></a></li>
</ul>
<h3 id="lefthook-install"><a class="header" href="#lefthook-install"><code>lefthook install</code></a></h3>
<p><code>lefthook install</code> creates an empty <code>lefthook.yml</code> if a configuration file does not exist and updates git hooks to use lefthook. Run <code>lefthook install</code> after cloning the git repo.</p>
<blockquote>
<p><strong>Note:</strong> NPM package <code>lefthook</code> installs the hooks in a postinstall script automatically</p>
</blockquote>
<h3 id="lefthook-uninstall"><a class="header" href="#lefthook-uninstall"><code>lefthook uninstall</code></a></h3>
<p><code>lefthook uninstall</code> clears git hooks affected by lefthook. If you have lefthook installed as an NPM package you should remove it manually.</p>
<h3 id="lefthook-add"><a class="header" href="#lefthook-add"><code>lefthook add</code></a></h3>
<p><code>lefthook add pre-commit</code> will create a file <code>.git/hooks/pre-commit</code>. This is the same lefthook does for <a href="usage/commands.html#lefthook-install"><code>install</code></a> command but you don't need to create a configuration first.</p>
<p>To use custom scripts as hooks create the required directories with <code>lefthook add pre-commit --dirs</code>.</p>
<p><strong>Example</strong></p>
<pre><code class="language-bash">$ lefthook add pre-push --dirs
</code></pre>
<p>Describe pre-push commands in <code>lefthook.yml</code>:</p>
<pre><code class="language-yml">pre-push:
  scripts:
    "audit.sh":
      runner: bash
</code></pre>
<p>Edit the script:</p>
<pre><code class="language-bash">$ vim .lefthook/pre-push/audit.sh
...
</code></pre>
<p>Run <code>git push</code> and lefthook will run <code>bash audit.sh</code> as a pre-push hook.</p>
<h3 id="lefthook-run"><a class="header" href="#lefthook-run"><code>lefthook run</code></a></h3>
<p><code>lefthook run</code> executes the commands and scripts configured for a given hook. Generated hooks call <code>lefthook run</code> implicitly.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint --fix

test:
  commands:
    js-test:
      run: yarn test
</code></pre>
<p>Install the hook.</p>
<pre><code class="language-bash">$ lefthook install
</code></pre>
<p>Run <code>test</code>.</p>
<pre><code class="language-bash">$ lefthook run test # will run 'yarn test'
</code></pre>
<p>Commit changes.</p>
<pre><code class="language-bash">$ git commit # will run pre-commit hook ('yarn lint --fix')
</code></pre>
<p>Or run manually also</p>
<pre><code class="language-bash">$ lefthook run pre-commit
</code></pre>
<p>You can also specify a flag to run only some commands:</p>
<pre><code class="language-bash">$ lefthook run pre-commit --commands lint
</code></pre>
<p>and optionally run either on all files (any <code>{staged_files}</code> placeholder acts as <code>{all_files}</code>) or a list of files:</p>
<pre><code class="language-bash">$ lefthook run pre-commit --all-files
$ lefthook run pre-commit --file file1.js --file file2.js
</code></pre>
<p>(if both are specified, <code>--all-files</code> is ignored)</p>
<h3 id="lefthook-version"><a class="header" href="#lefthook-version"><code>lefthook version</code></a></h3>
<p><code>lefthook version</code> prints the current binary version. Print the commit hash with <code>lefthook version --full</code></p>
<p><strong>Example</strong></p>
<pre><code class="language-bash">$ lefthook version --full

1.1.3 bb099d13c24114d2859815d9d23671a32932ffe2
</code></pre>
<h3 id="lefthook-self-update"><a class="header" href="#lefthook-self-update"><code>lefthook self-update</code></a></h3>
<p><code>lefthook self-update</code> updates the binary with the latest lefthook release on Github. This command is available only if you install lefthook from sources or download the binary from the Github Releases. For other ways use package-specific commands to update lefthook.</p>
<h3 id="lefthook-validate"><a class="header" href="#lefthook-validate"><code>lefthook validate</code></a></h3>
<p><code>lefthook validate</code> loads JSON schema from the Github repo and validates you main lefthook config (e.g. <code>lefthook.yml</code>) and secondary configs (<code>lefthook-local.yml</code>, configs from <code>extends</code> and <code>remotes</code>). Use <code>lefthook dump</code> to get the full config and locate the issue.</p>
<h3 id="lefthook-dump"><a class="header" href="#lefthook-dump"><code>lefthook dump</code></a></h3>
<p><code>lefthook dump</code> prints the merged config. This is the actual config lefthook uses, it can be build from the main config (<code>lefthook.yml</code>), remotes, extends, and <code>lefthook-local.yml</code> overrides.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="env-variables"><a class="header" href="#env-variables">ENV variables</a></h2>
<blockquote>
<p>ENV variables control some lefthook behavior. Most of them have the alternative CLI or config options.</p>
</blockquote>
<h3 id="lefthook"><a class="header" href="#lefthook"><code>LEFTHOOK</code></a></h3>
<p>Use <code>LEFTHOOK=0 git ...</code> or <code>LEFTHOOK=false git ...</code> to disable lefthook when running git commands.</p>
<p><strong>Example</strong></p>
<pre><code class="language-bash">LEFTHOOK=0 git commit -am "Lefthook skipped"
</code></pre>
<h3 id="lefthook_exclude"><a class="header" href="#lefthook_exclude"><code>LEFTHOOK_EXCLUDE</code></a></h3>
<p>Use <code>LEFTHOOK_EXCLUDE={list of tags or command names to be excluded}</code> to skip some commands or scripts by tag or name (for commands only). See the <a href="usage/../configuration/exclude_tags.html"><code>exclude_tags</code></a> configuration option for more details.</p>
<p><strong>Example</strong></p>
<pre><code class="language-bash">LEFTHOOK_EXCLUDE=ruby,security,lint git commit -am "Skip some tag checks"
</code></pre>
<h3 id="lefthook_output"><a class="header" href="#lefthook_output"><code>LEFTHOOK_OUTPUT</code></a></h3>
<p>Use <code>LEFTHOOK_OUTPUT={list of output values}</code> to specify what to print in your output. You can also set <code>LEFTHOOK_OUTPUT=false</code> to disable all output except for errors. Refer to the <a href="usage/../configuration/output.html"><code>output</code></a> configuration option for more details.</p>
<p><strong>Example</strong></p>
<pre><code class="language-bash">$ LEFTHOOK_OUTPUT=summary lefthook run pre-commit
summary: (done in 0.52 seconds)
‚úîÔ∏è  lint
</code></pre>
<h3 id="lefthook_quiet"><a class="header" href="#lefthook_quiet"><code>LEFTHOOK_QUIET</code></a></h3>
<p>You can skip some outputs printed by lefthook by setting the <code>LEFTHOOK_QUIET</code> environment variable. Provide a list of output types to be skipped. See the <a href="usage/../configuration/skip_output.html"><code>skip_output</code></a> configuration option for more details.</p>
<p><strong>Example</strong></p>
<pre><code class="language-bash">$ LEFTHOOK_QUIET=meta,execution lefthook run pre-commit

  EXECUTE &gt; lint

SUMMARY: (done in 0.01 seconds)
ü•ä  lint
</code></pre>
<h3 id="lefthook_verbose"><a class="header" href="#lefthook_verbose"><code>LEFTHOOK_VERBOSE</code></a></h3>
<p>Set <code>LEFTHOOK_VERBOSE=1</code> or <code>LEFTHOOK_VERBOSE=true</code> to enable verbose printing.</p>
<h3 id="lefthook_bin"><a class="header" href="#lefthook_bin"><code>LEFTHOOK_BIN</code></a></h3>
<p>Set <code>LEFTHOOK_BIN</code> to a location where lefthook is installed to use that instead of trying to detect from the it the PATH or from a package manager.</p>
<p>Useful for cases when:</p>
<ul>
<li>lefthook is installed multiple ways, and you want to be explicit about which one is used (example: installed through homebrew, but also is in Gemfile but you are using a ruby version manager like rbenv that prepends it to the path)</li>
<li>debugging and/or developing lefthook</li>
</ul>
<h3 id="no_color"><a class="header" href="#no_color"><code>NO_COLOR</code></a></h3>
<p>Set <code>NO_COLOR=true</code> to disable colored output in lefthook and all subcommands that lefthook calls.</p>
<h3 id="clicolor_force"><a class="header" href="#clicolor_force"><code>CLICOLOR_FORCE</code></a></h3>
<p>Set <code>CLICOLOR_FORCE=true</code> to force colored output in lefthook and all subcommands.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tips"><a class="header" href="#tips">Tips</a></h2>
<blockquote>
<p>Small tips for better experience with lefthook</p>
</blockquote>
<h3 id="local-config"><a class="header" href="#local-config">Local config</a></h3>
<p>Use <code>lefthook-local.yml</code> to overwrite or extend options from the main config. (Don't forget to add this file to <code>.gitignore</code>)</p>
<h3 id="disable-lefthook-in-ci"><a class="header" href="#disable-lefthook-in-ci">Disable lefthook in CI</a></h3>
<p>When using NPM package <code>lefthook</code> set <code>CI=true</code> in your CI (if it does not set automatically). When <code>CI=true</code> is set lefthook NPM package won't install the hooks in the postinstall script.</p>
<h3 id="commitlint-example"><a class="header" href="#commitlint-example">Commitlint example</a></h3>
<p>Let's create a bash script to check conventional commit status <code>.lefthook/commit-msg/commitlint.sh</code>:</p>
<pre><code class="language-bash">echo $(head -n1 $1) | npx commitlint --color
</code></pre>
<p>Now we can ask lefthook to run our bash script by adding this code to
<code>lefthook.yml</code> file:</p>
<pre><code class="language-yml"># lefthook.yml

commit-msg:
  scripts:
    "commitlint.sh":
      runner: bash
</code></pre>
<p>When you try to commit <code>git commit -m "haha bad commit text"</code> script <code>commitlint.sh</code> will be executed. Since commit text doesn't match the default config or custom config that you setup for <code>commitlint</code>, the process will be interrupted.</p>
<h3 id="parallel-execution"><a class="header" href="#parallel-execution">Parallel execution</a></h3>
<p>You can enable parallel execution if you want to speed up your checks.
Lets imagine we have the following rules to lint the whole project:</p>
<pre><code>bundle exec rubocop --parallel &amp;&amp; \
bundle exec danger &amp;&amp; \
yarn eslint --ext .es6 app/assets/javascripts &amp;&amp; \
yarn eslint --ext .es6 test/javascripts &amp;&amp; \
yarn eslint --ext .es6 plugins/**/assets/javascripts &amp;&amp; \
yarn eslint --ext .es6 plugins/**/test/javascripts &amp;&amp; \
yarn eslint app/assets/javascripts test/javascripts
</code></pre>
<p>Rewrite it in lefthook custom group. We call it <code>lint</code>:</p>
<pre><code class="language-yml"># lefthook.yml

lint:
  parallel: true
  commands:
    rubocop:
      run: bundle exec rubocop --parallel
    danger:
      run: bundle exec danger
    eslint-assets:
      run: yarn eslint --ext .es6 app/assets/javascripts
    eslint-test:
      run: yarn eslint --ext .es6 test/javascripts
    eslint-plugins-assets:
      run: yarn eslint --ext .es6 plugins/**/assets/javascripts
    eslint-plugins-test:
      run: yarn eslint --ext .es6 plugins/**/test/javascripts
    eslint-assets-tests:
      run: yarn eslint app/assets/javascripts test/javascripts
</code></pre>
<p>Then call this group directly:</p>
<pre><code>lefthook run lint
</code></pre>
<h3 id="concurrent-files-overrides"><a class="header" href="#concurrent-files-overrides">Concurrent files overrides</a></h3>
<p>To prevent concurrent problems with read/write files try <code>flock</code>
utility.</p>
<pre><code class="language-yml"># lefthook.yml

graphql-schema:
  glob: "{Gemfile.lock,app/graphql/**/*}"
  run: flock webpack/application/typings/graphql-schema.json yarn typings:update &amp;&amp; git diff --exit-code --stat HEAD webpack/application/typings
frontend-tests:
  glob: "**/*.js"
  run: flock -s webpack/application/typings/graphql-schema.json yarn test --findRelatedTests {files}
frontend-typings:
  glob: "**/*.js"
  run: flock -s webpack/application/typings/graphql-schema.json yarn run flow focus-check {files}
</code></pre>
<h3 id="capture-args-from-git-in-the-script"><a class="header" href="#capture-args-from-git-in-the-script">Capture ARGS from git in the script</a></h3>
<p>Example script for <code>prepare-commit-msg</code> hook:</p>
<pre><code class="language-bash">COMMIT_MSG_FILE=$1
COMMIT_SOURCE=$2
SHA1=$3

# ...
</code></pre>
<h3 id="git-lfs-support"><a class="header" href="#git-lfs-support">Git LFS support</a></h3>
<blockquote>
<p><strong>Note:</strong> If git-lfs binary is not installed and not required in your project, LFS hooks won't be executed, and you won't be warned about it.</p>
</blockquote>
<p>Lefthook runs LFS hooks internally for the following hooks:</p>
<ul>
<li>post-checkout</li>
<li>post-commit</li>
<li>post-merge</li>
<li>pre-push</li>
</ul>
<p>Errors are suppressed if git LFS is not required for the project. You can use <a href="usage/./env.html#lefthook_verbose"><code>LEFTHOOK_VERBOSE</code></a> ENV to make lefthook show git LFS output.</p>
<p>To avoid using LFS set <a href="usage/../configuration/skip_lfs.html"><code>skip_lfs: true</code></a> in lefthook.yml or lefthook-local.yml</p>
<h3 id="pass-stdin-to-a-command-or-script"><a class="header" href="#pass-stdin-to-a-command-or-script">Pass stdin to a command or script</a></h3>
<p>When you need to read the data from stdin ‚Äì specify <a href="usage/../configuration/use_stdin.html"><code>use_stdin: true</code></a>. This option is good when you write a command or script that receives data from git using stdin (for the <code>pre-push</code> hook, for example).</p>
<h3 id="using-an-interactive-command-or-script"><a class="header" href="#using-an-interactive-command-or-script">Using an interactive command or script</a></h3>
<p>When you need to interact with user ‚Äì specify <a href="usage/../configuration/interactive.html"><code>interactive: true</code></a>. Lefthook will connect to the current TTY and forward it to your command's or script's stdin.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="config-file-name"><a class="header" href="#config-file-name">Config file name</a></h2>
<p>Lefthook supports the following file names for the main config:</p>
<ul>
<li><code>lefthook.yml</code></li>
<li><code>.lefthook.yml</code></li>
<li><code>lefthook.yaml</code></li>
<li><code>.lefthook.yaml</code></li>
<li><code>lefthook.toml</code></li>
<li><code>.lefthook.toml</code></li>
<li><code>lefthook.json</code></li>
<li><code>.lefthook.json</code></li>
</ul>
<p>If there are more than 1 file in the project, only one will be used, and you'll never know which one. So, please, use one format in a project.</p>
<p>Lefthook also merges an extra config with the name <code>lefthook-local</code>. All supported formats can be applied to this <code>-local</code> config. If you name your main config with the leading dot, like <code>.lefthook.json</code>, the <code>-local</code> config also must be named with the leading dot: <code>.lefthook-local.json</code>.</p>
<h2 id="options"><a class="header" href="#options">Options</a></h2>
<ul>
<li><a href="configuration/./assert_lefthook_installed.html"><code>assert_lefthook_installed</code></a></li>
<li><a href="configuration/./colors.html"><code>colors</code></a></li>
<li><a href="configuration/./extends.html"><code>extends</code></a></li>
<li><a href="configuration/./lefthook.html"><code>lefthook</code></a></li>
<li><a href="configuration/./min_version.html"><code>min_version</code></a></li>
<li><a href="configuration/./no_tty.html"><code>no_tty</code></a></li>
<li><a href="configuration/./output.html"><code>output</code></a></li>
<li><a href="configuration/./rc.html"><code>rc</code></a></li>
<li><a href="configuration/./remotes.html"><code>remotes</code></a>
<ul>
<li><a href="configuration/./git_url.html"><code>git_url</code></a></li>
<li><a href="configuration/./ref.html"><code>ref</code></a></li>
<li><a href="configuration/./refetch.html"><code>refetch</code></a></li>
<li><a href="configuration/./refetch_frequency.html"><code>refetch_frequency</code></a></li>
<li><a href="configuration/./configs.html"><code>configs</code></a></li>
</ul>
</li>
<li><a href="configuration/./skip_output.html"><code>skip_output</code></a></li>
<li><a href="configuration/./source_dir.html"><code>source_dir</code></a></li>
<li><a href="configuration/./source_dir_local.html"><code>source_dir_local</code></a></li>
<li><a href="configuration/./skip_lfs.html"><code>skip_lfs</code></a></li>
<li><a href="configuration/./templates.html"><code>templates</code></a></li>
<li><a href="configuration/./Hook.html">{Git hook name}</a> (e.g. <code>pre-commit</code>)
<ul>
<li><a href="configuration/./files-global.html"><code>files</code> (global)</a></li>
<li><a href="configuration/./parallel.html"><code>parallel</code></a></li>
<li><a href="configuration/./piped.html"><code>piped</code></a></li>
<li><a href="configuration/./follow.html"><code>follow</code></a></li>
<li><a href="configuration/./exclude_tags.html"><code>exclude_tags</code></a></li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./jobs.html"><code>jobs</code></a>
<ul>
<li><a href="configuration/./name.html"><code>name</code></a></li>
<li><a href="configuration/./run.html"><code>run</code></a></li>
<li><a href="configuration/./script.html"><code>script</code></a></li>
<li><a href="configuration/./runner.html"><code>runner</code></a></li>
<li><a href="configuration/./group.html"><code>group</code></a>
<ul>
<li><a href="configuration/./parallel.html"><code>parallel</code></a></li>
<li><a href="configuration/./piped.html"><code>piped</code></a></li>
<li><a href="configuration/./jobs.html"><code>jobs</code></a></li>
</ul>
</li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./glob.html"><code>glob</code></a></li>
<li><a href="configuration/./files.html"><code>files</code></a></li>
<li><a href="configuration/./file_types.html"><code>file_types</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./root.html"><code>root</code></a></li>
<li><a href="configuration/./exclude.html"><code>exclude</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
</ul>
</li>
<li><a href="configuration/./Commands.html"><code>commands</code></a>
<ul>
<li><a href="configuration/./run.html"><code>run</code></a></li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./glob.html"><code>glob</code></a></li>
<li><a href="configuration/./files.html"><code>files</code></a></li>
<li><a href="configuration/./file_types.html"><code>file_types</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./root.html"><code>root</code></a></li>
<li><a href="configuration/./exclude.html"><code>exclude</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
<li><a href="configuration/./priority.html"><code>priority</code></a></li>
</ul>
</li>
<li><a href="configuration/./Scripts.html"><code>scripts</code></a>
<ul>
<li><a href="configuration/./runner.html"><code>runner</code></a></li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
<li><a href="configuration/./priority.html"><code>priority</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="assert_lefthook_installed"><a class="header" href="#assert_lefthook_installed"><code>assert_lefthook_installed</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<p>When set to <code>true</code>, fail (with exit status 1) if <code>lefthook</code> executable can't be found in $PATH, under node_modules/, as a Ruby gem, or other supported method. This makes sure git hook won't omit <code>lefthook</code> rules if <code>lefthook</code> ever was installed.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="colors"><a class="header" href="#colors"><code>colors</code></a></h2>
<p><strong>Default: <code>auto</code></strong></p>
<p>Whether enable or disable colorful output of Lefthook. This option can be overwritten with <code>--colors</code> option. You can also provide your own color codes.</p>
<p><strong>Example</strong></p>
<p>Disable colors.</p>
<pre><code class="language-yml"># lefthook.yml

colors: false
</code></pre>
<p>Custom color codes. Can be hex or ANSI codes.</p>
<pre><code class="language-yml"># lefthook.yml

colors:
  cyan: 14
  gray: 244
  green: '#32CD32'
  red: '#FF1493'
  yellow: '#F0E68C'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="extends"><a class="header" href="#extends"><code>extends</code></a></h2>
<p>You can extend your config with another one YAML file. Its content will be merged. Extends for <code>lefthook.yml</code>, <code>lefthook-local.yml</code>, and <a href="configuration/./remotes.html"><code>remotes</code></a> configs are handled separately, so you can have different extends in these files.</p>
<p>You can use asterisk to make a glob.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

extends:
  - /home/user/work/lefthook-extend.yml
  - /home/user/work/lefthook-extend-2.yml
  - lefthook-extends/file.yml
  - ../extend.yml
  - projects/*/specific-lefthook-config.yml
</code></pre>
<blockquote>
<p>The extends will be merged to the main configuration in your file. Here is the order of settings applied:</p>
<ul>
<li><code>lefthook.yml</code> ‚Äì main config file</li>
<li><code>extends</code> ‚Äì configs specified in <a href="configuration/./extends.html">extends</a> option</li>
<li><code>remotes</code> ‚Äì configs specified in <a href="configuration/./remotes.html">remotes</a> option</li>
<li><code>lefthook-local.yml</code> ‚Äì local config file</li>
</ul>
<p>So, <code>extends</code> override settings from <code>lefthook.yml</code>, <code>remotes</code> override <code>extends</code>, and <code>lefthook-local.yml</code> can override everything.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="lefthook-1"><a class="header" href="#lefthook-1"><code>lefthook</code></a></h2>
<p><strong>Default:</strong> <code>null</code></p>
<blockquote>
<p>Added in lefthook <code>1.10.5</code></p>
</blockquote>
<p>Provide a full path to lefthook executable or a command to run lefthook. Bourne shell (<code>sh</code>) syntax is supported.</p>
<blockquote>
<p><strong>Important:</strong> This option does not merge from <code>remotes</code> or <code>extends</code> for security reasons. But it gets merged from lefthook local config if specified.</p>
</blockquote>
<p>There are three reasons you may want to specify <code>lefthook</code>:</p>
<ol>
<li>You want to force using specific lefthook version from your dependencies (e.g. npm package)</li>
<li>You use PnP loader for your JS/TS project, and your <code>package.json</code> with lefthook dependency locates in a subfolder</li>
<li>You want to make sure you use concrete lefthook executable path and want to defined it in <code>lefthook-local.yml</code></li>
</ol>
<h3 id="examples"><a class="header" href="#examples">Examples</a></h3>
<h4 id="specify-lefthook-executable"><a class="header" href="#specify-lefthook-executable">Specify lefthook executable</a></h4>
<pre><code class="language-yml"># lefthook.yml

lefthook: /usr/bin/lefthook

pre-commit:
  jobs:
    - run: yarn lint
</code></pre>
<h4 id="specify-a-command-to-run-lefthook"><a class="header" href="#specify-a-command-to-run-lefthook">Specify a command to run lefthook</a></h4>
<pre><code class="language-yml"># lefthook.yml

lefthook: |
  cd project-with-lefthook
  pnpm lefthook

pre-commit:
  jobs:
    - run: yarn lint
      root: project-with-lefthook
</code></pre>
<h4 id="force-using-a-version-from-rubygems"><a class="header" href="#force-using-a-version-from-rubygems">Force using a version from Rubygems</a></h4>
<pre><code class="language-yml"># lefthook.yml

lefthook: bundle exec lefthook

pre-commit:
  jobs:
    - run: bundle exec rubocop {staged_files}
</code></pre>
<h4 id="enable-debug-logs"><a class="header" href="#enable-debug-logs">Enable debug logs</a></h4>
<pre><code class="language-yml"># lefthook-local.yml

lefthook: lefthook --verbose
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="min_version"><a class="header" href="#min_version"><code>min_version</code></a></h2>
<p>If you want to specify a minimum version for lefthook binary (e.g. if you need some features older versions don't have) you can set this option.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

min_version: 1.1.3
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="no_tty"><a class="header" href="#no_tty"><code>no_tty</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<p>Whether hide spinner and other interactive things. This can be also controlled with <code>--no-tty</code> option for <code>lefthook run</code> command.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

no_tty: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="output"><a class="header" href="#output"><code>output</code></a></h2>
<p>You can manage verbosity using the <code>output</code> config. You can specify what to print in your output by setting these values, which you need to have</p>
<p>Possible values are <code>meta,summary,success,failure,execution,execution_out,execution_info,skips</code>.
By default, all output values are enabled</p>
<p>You can also disable all output with setting <code>output: false</code>. In this case only errors will be printed.</p>
<p>This config quiets all outputs except for errors.</p>
<p><code>output</code> is enabled if there is no <code>skip_output</code> and <code>LEFTHOOK_QUIET</code>.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

output:
  - meta           # Print lefthook version
  - summary        # Print summary block (successful and failed steps)
  - empty_summary  # Print summary heading when there are no steps to run
  - success        # Print successful steps
  - failure        # Print failed steps printing
  - execution      # Print any execution logs
  - execution_out  # Print execution output
  - execution_info # Print `EXECUTE &gt; ...` logging
  - skips          # Print "skip" (i.e. no files matched)
</code></pre>
<p>You can also <em>extend</em> this list with an environment variable <code>LEFTHOOK_OUTPUT</code>:</p>
<pre><code class="language-bash">LEFTHOOK_OUTPUT="meta,success,summary" lefthook run pre-commit
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="rc"><a class="header" href="#rc"><code>rc</code></a></h2>
<p>Provide an <a href="https://www.baeldung.com/linux/rc-files"><strong>rc</strong></a> file, which is actually a simple <code>sh</code> script. Currently it can be used to set ENV variables that are not accessible from non-shell programs.</p>
<p><strong>Example</strong></p>
<p>Use cases:</p>
<ul>
<li>You have a GUI program that runs git hooks (e.g., VSCode)</li>
<li>You reference executables that are accessible only from a tweaked $PATH environment variable (e.g., when using rbenv or nvm, fnm)</li>
<li>Or even if your GUI program cannot locate the <code>lefthook</code> executable :scream:</li>
<li>Or if you want to use ENV variables that control the executables behavior in <code>lefthook.yml</code></li>
</ul>
<pre><code class="language-bash"># An npm executable which is managed by nvm
$ which npm
/home/user/.nvm/versions/node/v15.14.0/bin/npm
</code></pre>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: npm run eslint {staged_files}
</code></pre>
<p>Provide a tweak to access <code>npm</code> executable the same way you do it in your ~/<shell>rc.</p>
<pre><code class="language-yml"># lefthook-local.yml

# You can choose whatever name you want.
# You can share it between projects where you use lefthook.
# Make sure the path is absolute.
rc: ~/.lefthookrc
</code></pre>
<p>Or</p>
<pre><code class="language-yml"># lefthook-local.yml

# If the path contains spaces, you need to quote it.
rc: '"${XDG_CONFIG_HOME:-$HOME/.config}/lefthookrc"'
</code></pre>
<p>In the rc file, export any new environment variables or modify existing ones.</p>
<pre><code class="language-bash"># ~/.lefthookrc

# An nvm way
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] &amp;&amp; \. "$NVM_DIR/nvm.sh"

# An fnm way
export FNM_DIR="$HOME/.fnm"
[ -s "$FNM_DIR/fnm.sh" ] &amp;&amp; \. "$FNM_DIR/fnm.sh"

# Or maybe just
PATH=$PATH:$HOME/.nvm/versions/node/v15.14.0/bin
</code></pre>
<pre><code class="language-bash"># Make sure you updated git hooks. This is important.
$ lefthook install -f
</code></pre>
<p>Now any program that runs your hooks will have a tweaked PATH environment variable and will be able to get <code>nvm</code> :wink:</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="remotes"><a class="header" href="#remotes"><code>remotes</code></a></h2>
<p>You can provide multiple remote configs if you want to share yours lefthook configurations across many projects. Lefthook will automatically download and merge configurations into your local <code>lefthook.yml</code>.</p>
<p>You can use <a href="configuration/./extends.html"><code>extends</code></a> but the paths must be relative to the remote repository root.</p>
<p>If you provide <a href="configuration/./scripts.html"><code>scripts</code></a> in a remote config file, the <a href="configuration/./source_dir.html">scripts</a> folder must also be in the <strong>root of the repository</strong>.</p>
<p><strong>Note</strong></p>
<p>The configuration from <code>remotes</code> will be merged to the local config using the following priority:</p>
<ol>
<li>Local main config (<code>lefthook.yml</code>)</li>
<li>Remote configs (<code>remotes</code>)</li>
<li>Local overrides (<code>lefthook-local.yml</code>)</li>
</ol>
<p>This priority may be changed in the future. For convenience, if you use <code>remotes</code>, please don't configure any hooks.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="git_url"><a class="header" href="#git_url"><code>git_url</code></a></h2>
<p>A URL to Git repository. It will be accessed with privileges of the machine lefthook runs on.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

remotes:
  - git_url: git@github.com:evilmartians/lefthook
</code></pre>
<p>Or</p>
<pre><code class="language-yml"># lefthook.yml

remotes:
  - git_url: https://github.com/evilmartians/lefthook
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="ref"><a class="header" href="#ref"><code>ref</code></a></h2>
<p>An optional <em>branch</em> or <em>tag</em> name.</p>
<blockquote>
<p><strong>Note:</strong> If you initially had <code>ref</code> option, ran <code>lefthook install</code>, and then removed it, lefthook won't decide which branch/tag to use as a ref. So, if you added it once, please, use it always to avoid issues in local setups.</p>
</blockquote>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

remotes:
  - git_url: git@github.com:evilmartians/lefthook
    ref: v1.0.0
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="refetch"><a class="header" href="#refetch"><code>refetch</code></a></h2>
<p><strong>Default:</strong> <code>false</code></p>
<p>Force remote config refetching on every run. Lefthook will be refetching the specified remote every time it is called.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

remotes:
  - git_url: https://github.com/evilmartians/lefthook
    refetch: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="refetch_frequency"><a class="header" href="#refetch_frequency"><code>refetch_frequency</code></a></h2>
<p><strong>Default:</strong> Not set</p>
<p>Specifies how frequently Lefthook should refetch the remote configuration. This can be set to <code>always</code>, <code>never</code> or a time duration like <code>24h</code>, <code>30m</code>, etc.</p>
<ul>
<li>When set to <code>always</code>, Lefthook will always refetch the remote configuration on each run.</li>
<li>When set to a duration (e.g., <code>24h</code>), Lefthook will check the last fetch time and refetch the configuration only if the specified amount of time has passed.</li>
<li>When set to <code>never</code> or not set, Lefthook will not fetch from remote.</li>
</ul>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

remotes:
  - git_url: https://github.com/evilmartians/lefthook
    refetch_frequency: 24h # Refetches once every 24 hours
</code></pre>
<blockquote>
<p>WARNING
If <code>refetch</code> is set to <code>true</code>, it overrides any setting in <code>refetch_frequency</code>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="configs"><a class="header" href="#configs"><code>configs</code></a></h2>
<p><strong>Default:</strong> <code>[lefthook.yml]</code></p>
<p>An optional array of config paths from remote's root.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

remotes:
  - git_url: git@github.com:evilmartians/lefthook
    ref: v1.0.0
    configs:
      - examples/ruby-linter.yml
      - examples/test.yml
</code></pre>
<p>Example with multiple remotes merging multiple configurations.</p>
<pre><code class="language-yml"># lefthook.yml

remotes:
  - git_url: git@github.com:org/lefthook-configs
    ref: v1.0.0
    configs:
      - examples/ruby-linter.yml
      - examples/test.yml
  - git_url: https://github.com/org2/lefthook-configs
    configs:
      - lefthooks/pre_commit.yml
      - lefthooks/post_merge.yml
  - git_url: https://github.com/org3/lefthook-configs
    ref: feature/new
    configs:
      - configs/pre-push.yml

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="skip_output"><a class="header" href="#skip_output"><code>skip_output</code></a></h2>
<blockquote>
<p><strong>DEPRECATED</strong> This feature is deprecated and might be removed in future versions. Please, use <a href="configuration/./output.html"><code>output</code></a> instead for managing verbosity.</p>
</blockquote>
<p>You can manage the verbosity using the <code>skip_output</code> config. You can set whether lefthook should print some parts of its output.</p>
<p>Possible values are <code>meta,summary,success,failure,execution,execution_out,execution_info,skips</code>.</p>
<p>You can also disable all output with setting <code>skip_output: true</code>. In this case only errors will be printed.</p>
<p>This config quiets all outputs except for errors.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

skip_output:
  - meta           # Skips lefthook version printing
  - summary        # Skips summary block (successful and failed steps) printing
  - empty_summary  # Skips summary heading when there are no steps to run
  - success        # Skips successful steps printing
  - failure        # Skips failed steps printing
  - execution      # Skips printing any execution logs (but prints if the execution failed)
  - execution_out  # Skips printing execution output (but still prints failed commands output)
  - execution_info # Skips printing `EXECUTE &gt; ...` logging
  - skips          # Skips "skip" printing (i.e. no files matched)
</code></pre>
<p>You can also <em>extend</em> this list with an environment variable <code>LEFTHOOK_QUIET</code>:</p>
<pre><code class="language-bash">LEFTHOOK_QUIET="meta,success,summary" lefthook run pre-commit
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="source_dir"><a class="header" href="#source_dir"><code>source_dir</code></a></h2>
<p><strong>Default: <code>.lefthook/</code></strong></p>
<p>Change a directory for script files. Directory for script files contains folders with git hook names which contain script files.</p>
<p>Example of directory tree:</p>
<pre><code>.lefthook/
‚îú‚îÄ‚îÄ pre-commit/
‚îÇ   ‚îú‚îÄ‚îÄ lint.sh
‚îÇ   ‚îî‚îÄ‚îÄ test.py
‚îî‚îÄ‚îÄ pre-push/
    ‚îî‚îÄ‚îÄ check-files.rb
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="source_dir_local"><a class="header" href="#source_dir_local"><code>source_dir_local</code></a></h2>
<p><strong>Default: <code>.lefthook-local/</code></strong></p>
<p>Change a directory for <em>local</em> script files (not stored in VCS).</p>
<p>This option is useful if you have a <code>lefthook-local.yml</code> config file and want to reference different scripts there.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="skip_lfs"><a class="header" href="#skip_lfs"><code>skip_lfs</code></a></h2>
<p><strong>Default:</strong> <code>false</code></p>
<p>Skip running LFS hooks even if it exists on your system.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<pre><code class="language-yml"># lefthook.yml

skip_lfs: true

pre-push:
  commands:
    test:
      run: yarn test
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="templates"><a class="header" href="#templates"><code>templates</code></a></h2>
<blockquote>
<p>Added in lefthook <code>1.10.8</code></p>
</blockquote>
<p>Provide custom replacement for templates in <code>run</code> values.</p>
<p>With <code>templates</code> you can specify what can be overridden via <code>lefthook-local.yml</code> without a need to overwrite every jobs in your configuration.</p>
<h2 id="example-1"><a class="header" href="#example-1">Example</a></h2>
<h3 id="override-with-lefthook-localyml"><a class="header" href="#override-with-lefthook-localyml">Override with lefthook-local.yml</a></h3>
<pre><code class="language-yml"># lefthook.yml

templates:
  dip: # empty

pre-commit:
  jobs:
    # Will run: `bundle exec rubocop file1 file2 file3 ...`
    - run: {dip} bundle exec rubocop {staged_files}
</code></pre>
<pre><code class="language-yml"># lefthook.yml

templates:
  dip: dip # Will run: `dip bundle exec rubocop file1 file2 file3 ...`
</code></pre>
<h3 id="reduce-redundancy"><a class="header" href="#reduce-redundancy">Reduce redundancy</a></h3>
<pre><code class="language-yml"># lefthook.yml

templates:
  wrapper: docker-compose run --rm -v $(pwd):/app service

pre-commit:
  jobs:
    - run: {wrapper} yarn format
    - run: {wrapper} yarn lint
    - run: {wrapper} yarn test
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="git-hook"><a class="header" href="#git-hook">Git hook</a></h2>
<p>Contains settings for the git hook (commands, scripts, skip rules, etc.). You can specify any Git hook or your own custom, e.g. <code>test</code></p>
<h3 id="hook-options"><a class="header" href="#hook-options">Hook options</a></h3>
<ul>
<li><a href="configuration/./files-global.html"><code>files</code></a></li>
<li><a href="configuration/./parallel.html"><code>parallel</code></a></li>
<li><a href="configuration/./piped.html"><code>piped</code></a></li>
<li><a href="configuration/./follow.html"><code>follow</code></a></li>
<li><a href="configuration/./exclude_tags.html"><code>exclude_tags</code></a></li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./jobs.html"><code>jobs</code></a>
<ul>
<li><a href="configuration/./name.html"><code>name</code></a></li>
<li><a href="configuration/./run.html"><code>run</code></a></li>
<li><a href="configuration/./script.html"><code>script</code></a></li>
<li><a href="configuration/./runner.html"><code>runner</code></a></li>
<li><a href="configuration/./group.html"><code>group</code></a>
<ul>
<li><a href="configuration/./parallel.html"><code>parallel</code></a></li>
<li><a href="configuration/./piped.html"><code>piped</code></a></li>
<li><a href="configuration/./jobs.html"><code>jobs</code></a></li>
</ul>
</li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./glob.html"><code>glob</code></a></li>
<li><a href="configuration/./files.html"><code>files</code></a></li>
<li><a href="configuration/./file_types.html"><code>file_types</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./root.html"><code>root</code></a></li>
<li><a href="configuration/./exclude.html"><code>exclude</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
</ul>
</li>
<li><a href="configuration/./Commands.html"><code>commands</code></a>
<ul>
<li><a href="configuration/./run.html"><code>run</code></a></li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./glob.html"><code>glob</code></a></li>
<li><a href="configuration/./files.html"><code>files</code></a></li>
<li><a href="configuration/./file_types.html"><code>file_types</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./root.html"><code>root</code></a></li>
<li><a href="configuration/./exclude.html"><code>exclude</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
<li><a href="configuration/./priority.html"><code>priority</code></a></li>
</ul>
</li>
<li><a href="configuration/./Scripts.html"><code>scripts</code></a>
<ul>
<li><a href="configuration/./runner.html"><code>runner</code></a></li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
<li><a href="configuration/./priority.html"><code>priority</code></a></li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="files-global"><a class="header" href="#files-global"><code>files</code> (global)</a></h2>
<p>A custom git command for files to be referenced in <code>{files}</code> template. See <a href="configuration/files-global.html#run"><code>run</code></a> and <a href="configuration/files-global.html#files"><code>files</code></a>.</p>
<p>If the result of this command is empty, the execution of commands will be skipped.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  files: git diff --name-only master # custom list of files
  commands:
    ...
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="parallel"><a class="header" href="#parallel"><code>parallel</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p><strong>Note:</strong> Lefthook runs commands and scripts <strong>sequentially</strong> by default</p>
</blockquote>
<p>Run commands and scripts concurrently.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="piped"><a class="header" href="#piped"><code>piped</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p><strong>Note:</strong> Lefthook will return an error if both <code>piped: true</code> and <code>parallel: true</code> are set</p>
</blockquote>
<p>Stop running commands and scripts if one of them fail.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

database:
  piped: true # Stop if one of the steps fail
  commands:
    1_create:
      run: rake db:create
    2_migrate:
      run: rake db:migrate
    3_seed:
      run: rake db:seed
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="follow"><a class="header" href="#follow"><code>follow</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<p>Follow the STDOUT of the running commands and scripts.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  follow: true
  commands:
    backend-tests:
      run: bundle exec rspec
    frontend-tests:
      run: yarn test
</code></pre>
<blockquote>
<p><strong>Note:</strong> If used with <a href="configuration/follow.html#parallel"><code>parallel</code></a> the output can be a mess, so please avoid setting both options to <code>true</code></p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="exclude_tags"><a class="header" href="#exclude_tags"><code>exclude_tags</code></a></h2>
<p><a href="configuration/./tags.html">Tags</a> or command names that you want to exclude. This option can be overwritten with <code>LEFTHOOK_EXCLUDE</code> env variable.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  exclude_tags: frontend
  commands:
    lint:
      tags: frontend
      ...
    test:
      tags: frontend
      ...
    check-syntax:
      tags: documentation
</code></pre>
<pre><code class="language-bash">lefthook run pre-commit # will only run check-syntax command
</code></pre>
<p><strong>Notes</strong></p>
<p>This option is good to specify in <code>lefthook-local.yml</code> when you want to skip some execution locally.</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    packages-audit:
      tags:
        - frontend
        - security
      run: yarn audit
    gems-audit:
      tags:
        - backend
        - security
      run: bundle audit
</code></pre>
<p>You can skip commands by tags:</p>
<pre><code class="language-yml"># lefthook-local.yml

pre-push:
  exclude_tags:
    - frontend
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="skip"><a class="header" href="#skip"><code>skip</code></a></h2>
<p>You can skip all or specific commands and scripts using <code>skip</code> option. You can also skip when merging, rebasing, or being on a specific branch. Globs are available for branches.</p>
<p>Possible skip values:</p>
<ul>
<li><code>rebase</code> - when in rebase git state</li>
<li><code>merge</code> - when in merge git state</li>
<li><code>merge-commit</code> - when current HEAD commit is the merge commit</li>
<li><code>ref: main</code> - when on a <code>main</code> branch</li>
<li><code>run: test ${SKIP_ME} -eq 1</code> - when <code>test ${SKIP_ME} -eq 1</code> is successful (return code is 0)</li>
</ul>
<p><strong>Example</strong></p>
<p>Always skipping a command:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: true
      run: yarn lint
</code></pre>
<p>Skipping on merging and rebasing:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip:
        - merge
        - rebase
      run: yarn lint
</code></pre>
<p>Or</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: merge
      run: yarn lint
</code></pre>
<p>Skipping when your are on a merge commit:</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    lint:
      skip: merge-commit
      run: yarn lint
</code></pre>
<p>Skipping the whole hook on <code>main</code> branch:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - ref: main
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>Skipping hook for all <code>dev/*</code> branches:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>Skipping hook by running a command:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - run: test "${NO_HOOK}" -eq 1
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<blockquote>
<p>TIP</p>
<p>Always skipping is useful when you have a <code>lefthook-local.yml</code> config and you don't want to run some commands locally. So you just overwrite the <code>skip</code> option for them to be <code>true</code>.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
</code></pre>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    lint:
      skip: true
</code></pre>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="only"><a class="header" href="#only"><code>only</code></a></h2>
<p>You can force a command, script, or the whole hook to execute only in certain conditions. This option acts like the opposite of <a href="configuration/./skip.html"><code>skip</code></a>. It accepts the same values but skips execution only if the condition is not satisfied.</p>
<blockquote>
<p><strong>Note:</strong> <code>skip</code> option takes precedence over <code>only</code> option, so if you have conflicting conditions the execution will be skipped.</p>
</blockquote>
<p><strong>Example</strong></p>
<p>Execute a hook only for <code>dev/*</code> branches.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  only:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>When rebasing execute quick linter but skip usual linter and tests.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: rebase
      run: yarn lint
    test:
      skip: rebase
      run: yarn test
    lint-on-rebase:
      only: rebase
      run: yarn lint-quickly
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="jobs"><a class="header" href="#jobs"><code>jobs</code></a></h2>
<blockquote>
<p>Added in lefthook <code>1.10.0</code></p>
</blockquote>
<p>Jobs provide a flexible way to define tasks, supporting both commands and scripts. Jobs can be grouped for advanced flow control.</p>
<h3 id="basic-example"><a class="header" href="#basic-example">Basic example</a></h3>
<p>Define jobs in your <code>lefthook.yml</code> file under a specific hook like <code>pre-commit</code>:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - run: yarn lint
    - run: yarn test
</code></pre>
<h3 id="differences-from-commands-and-scripts"><a class="header" href="#differences-from-commands-and-scripts">Differences from Commands and Scripts</a></h3>
<p><strong>Optional Job Names</strong></p>
<ul>
<li>Named jobs are merged across <a href="configuration/./extends.html"><code>extends</code></a> and local config.</li>
<li>Unnamed jobs are appended in the order of their definition.</li>
</ul>
<p><strong>Job Groups</strong></p>
<ul>
<li>Groups can include other jobs.</li>
<li>Flow within groups can be parallel or piped. Options <code>glob</code>, <code>root</code>, and <code>exclude</code> apply to all jobs in the group, including nested ones.</li>
</ul>
<h3 id="job-options"><a class="header" href="#job-options">Job options</a></h3>
<p>Below are the available options for configuring jobs.</p>
<ul>
<li><a href="configuration/./name.html"><code>name</code></a></li>
<li><a href="configuration/./run.html"><code>run</code></a></li>
<li><a href="configuration/./script.html"><code>script</code></a></li>
<li><a href="configuration/./runner.html"><code>runner</code></a></li>
<li><a href="configuration/./group.html"><code>group</code></a>
<ul>
<li><a href="configuration/./parallel.html"><code>parallel</code></a></li>
<li><a href="configuration/./piped.html"><code>piped</code></a></li>
<li><a href="configuration/./jobs.html"><code>jobs</code></a></li>
</ul>
</li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./glob.html"><code>glob</code></a></li>
<li><a href="configuration/./files.html"><code>files</code></a></li>
<li><a href="configuration/./file_types.html"><code>file_types</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./root.html"><code>root</code></a></li>
<li><a href="configuration/./exclude.html"><code>exclude</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
</ul>
<h3 id="example-2"><a class="header" href="#example-2">Example</a></h3>
<blockquote>
<p><strong>Note:</strong> Currently, only <code>root</code>, <code>glob</code>, and <code>exclude</code> options are applied to group jobs. Other options must be set for each job individually. Submit a <a href="https://github.com/evilmartians/lefthook/issues/new?assignees=&amp;labels=feature+request&amp;projects=&amp;template=feature_request.md">feature request</a> if this limits your workflow.</p>
</blockquote>
<p>A configuration demonstrating a piped group running in parallel with other jobs:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  parallel: true
  jobs:
    - name: migrate
      root: backend/
      glob: "db/migrations/*"
      group:
        piped: true
        jobs:
          - run: bundle install
          - run: rails db:migrate
    - run: yarn lint --fix {staged_files}
      root: frontend/
      stage_fixed: true
    - run: bundle exec rubocop
      root: backend/
    - run: golangci-lint
      root: proxy/
    - script: verify.sh
      runner: bash
</code></pre>
<p>This configuration runs migrate jobs in a piped flow while other jobs execute in parallel.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="name"><a class="header" href="#name"><code>name</code></a></h2>
<p>Name of a job. Will be printed in summary. If specified, the jobs can be merged with a jobs of the same name in a <a href="configuration/../examples/lefthook-local.html">local config</a> or <a href="configuration/./extends.html">extends</a>.</p>
<h3 id="example-3"><a class="header" href="#example-3">Example</a></h3>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - name: lint and fix
      run: yarn run eslint --fix {staged_files}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="run"><a class="header" href="#run"><code>run</code></a></h2>
<blockquote>
<p><strong>Note:</strong> <code>run</code> command is treated differently on Unix-like systems (macOS, Linux) and Windows:</p>
<ul>
<li>*<strong>nix</strong>: commands get wrapped with <code>sh -c '&lt;run&gt;'</code></li>
<li><strong>Windows</strong>: commands execute natively</li>
</ul>
<p>So, when on *nix systems you can use pipes, builtins of a Bourne Shell, etc. For Windows the capabilities are limited by a single command.</p>
</blockquote>
<p>This is a mandatory option for a command. This is actually a command that is executed for the hook.</p>
<p>You can use files templates that will be substituted with the appropriate files on execution:</p>
<ul>
<li><code>{files}</code> - custom <a href="configuration/./files.html"><code>files</code></a> command result.</li>
<li><code>{staged_files}</code> - staged files which you try to commit.</li>
<li><code>{push_files}</code> - files that are committed but not pushed.</li>
<li><code>{all_files}</code> - all files tracked by git.</li>
<li><code>{cmd}</code> - shorthand for the command from <code>lefthook.yml</code>.</li>
<li><code>{0}</code> - shorthand for the single space-joint string of git hook arguments.</li>
<li><code>{N}</code> - shorthand for the N-th git hook argument.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> Command line length has a limit on every system. If your list of files is quite long, lefthook splits your files list to fit in the limit and runs few commands sequentially.</p>
</blockquote>
<p><strong>Example</strong></p>
<p>Run <code>yarn lint</code> on <code>pre-commit</code> hook.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
</code></pre>
<h4 id="files-template"><a class="header" href="#files-template"><code>{files}</code> template</a></h4>
<p>Run <code>go vet</code> only on files listed with <code>git ls-files -m</code> command with <code>.go</code> extension.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    govet:
      files: git ls-files -m
      glob: "*.go"
      run: go vet {files}
</code></pre>
<h4 id="staged_files-template"><a class="header" href="#staged_files-template"><code>{staged_files}</code> template</a></h4>
<p>Run <code>yarn eslint</code> only on staged files with <code>.js</code>, <code>.ts</code>, <code>.jsx</code>, and <code>.tsx</code> extensions.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    eslint:
      glob: "*.{js,ts,jsx,tsx}"
      run: yarn eslint {staged_files}
</code></pre>
<h4 id="push_files-template"><a class="header" href="#push_files-template"><code>{push_files}</code> template</a></h4>
<p>If you want to lint files only before pushing them.</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    eslint:
      glob: "*.{js,ts,jsx,tsx}"
      run: yarn eslint {push_files}
</code></pre>
<h4 id="all_files-template"><a class="header" href="#all_files-template"><code>{all_files}</code> template</a></h4>
<p>Simply run <code>bundle exec rubocop</code> on all files with <code>.rb</code> extension excluding <code>application.rb</code> and <code>routes.rb</code> files.</p>
<blockquote>
<p><strong>Note:</strong> <code>--force-exclusion</code> will apply <code>Exclude</code> configuration setting of Rubocop</p>
</blockquote>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    rubocop:
      tags:
        - backend
        - style
      glob: "*.rb"
      exclude:
        - config/application.rb
        - config/routes.rb
      run: bundle exec rubocop --force-exclusion {all_files}
</code></pre>
<h4 id="cmd-template"><a class="header" href="#cmd-template"><code>{cmd}</code> template</a></h4>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
  scripts:
    "good_job.js":
      runner: node
</code></pre>
<p>You can wrap it in docker runner locally:</p>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    lint:
      run: docker run -it --rm &lt;container_id_or_name&gt; {cmd}
  scripts:
    "good_job.js":
      runner: docker run -it --rm &lt;container_id_or_name&gt; {cmd}
</code></pre>
<h4 id="git-arguments"><a class="header" href="#git-arguments">Git arguments</a></h4>
<p>Make sure commits are signed.</p>
<pre><code class="language-yml"># lefthook.yml

# Note: commit-msg hook takes a single parameter,
#       the name of the file that holds the proposed commit log message.
# Source: https://git-scm.com/docs/githooks#_commit_msg
commit-msg:
  commands:
    multiple-sign-off:
      run: 'test $(grep -c "^Signed-off-by: " {1}) -lt 2'
</code></pre>
<h4 id="rubocop"><a class="header" href="#rubocop">Rubocop</a></h4>
<p>If using <code>{all_files}</code> with RuboCop, it will ignore RuboCop's <code>Exclude</code> configuration setting. To avoid this, pass <code>--force-exclusion</code>.</p>
<h4 id="quotes"><a class="header" href="#quotes">Quotes</a></h4>
<p>If you want to have all your files quoted with double quotes <code>"</code> or single quotes <code>'</code>, quote the appropriate shorthand:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      glob: "*.js"
      # Quoting with double quotes `"` might be helpful for Windows users
      run: yarn eslint "{staged_files}" # will run `yarn eslint "file1.js" "file2.js" "[strange name].js"`
    test:
      glob: "*.{spec.js}"
      run: yarn test '{staged_files}' # will run `yarn eslint 'file1.spec.js' 'file2.spec.js' '[strange name].spec.js'`
    format:
      glob: "*.js"
      # Will quote where needed with single quotes
      run: yarn test {staged_files} # will run `yarn eslint file1.js file2.js '[strange name].spec.js'`
</code></pre>
<h4 id="scripts"><a class="header" href="#scripts">Scripts</a></h4>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - name: a whole script in a run
      run: |
        for file in $(ls .); do
          yarn lint $file
        done
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="script"><a class="header" href="#script"><code>script</code></a></h2>
<p>Name of a script to execute. The rules are the same as for <a href="configuration/./Scripts.html"><code>scripts</code></a></p>
<h3 id="example-4"><a class="header" href="#example-4">Example</a></h3>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - script: linter.sh
      runner: bash
</code></pre>
<pre><code class="language-bash"># .lefthook/pre-commit/linter.sh

echo "Everything is OK"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="runner"><a class="header" href="#runner"><code>runner</code></a></h2>
<p>You should specify a runner for the script. This is a command that should execute a script file. It will be called the following way: <code>&lt;runner&gt; &lt;path-to-script&gt;</code> (e.g. <code>ruby .lefthook/pre-commit/lint.rb</code>).</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  scripts:
    "lint.js":
      runner: node
    "check.go":
      runner: go run
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="group"><a class="header" href="#group"><code>group</code></a></h2>
<p>You can define a group of jobs and configure how they should execute using the following options:</p>
<ul>
<li><a href="configuration/./parallel.html"><code>parallel</code></a>: Executes all jobs in the group simultaneously.</li>
<li><a href="configuration/./piped.html"><code>piped</code></a>: Executes jobs sequentially, passing output between them.</li>
<li><a href="configuration/./jobs.html"><code>jobs</code></a>: Specifies the jobs within the group.</li>
</ul>
<h3 id="example-5"><a class="header" href="#example-5">Example</a></h3>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - group:
        parallel: true
        jobs:
          - run: echo 1
          - run: echo 2
          - run: echo 3
</code></pre>
<blockquote>
<p><strong>Note:</strong> To make a group mergeable with settings defined in local config or extends you have to specify the name of the job group belongs to:</p>
<pre><code class="language-yml">pre-commit:
  jobs:
    - name: a name of a group
      group:
        jobs:
          - name: lint
            run: yarn lint
          - name: test
            run: yarn test
</code></pre>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="parallel-1"><a class="header" href="#parallel-1"><code>parallel</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p><strong>Note:</strong> Lefthook runs commands and scripts <strong>sequentially</strong> by default</p>
</blockquote>
<p>Run commands and scripts concurrently.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="piped-1"><a class="header" href="#piped-1"><code>piped</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p><strong>Note:</strong> Lefthook will return an error if both <code>piped: true</code> and <code>parallel: true</code> are set</p>
</blockquote>
<p>Stop running commands and scripts if one of them fail.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

database:
  piped: true # Stop if one of the steps fail
  commands:
    1_create:
      run: rake db:create
    2_migrate:
      run: rake db:migrate
    3_seed:
      run: rake db:seed
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="jobs-1"><a class="header" href="#jobs-1"><code>jobs</code></a></h2>
<blockquote>
<p>Added in lefthook <code>1.10.0</code></p>
</blockquote>
<p>Jobs provide a flexible way to define tasks, supporting both commands and scripts. Jobs can be grouped for advanced flow control.</p>
<h3 id="basic-example-1"><a class="header" href="#basic-example-1">Basic example</a></h3>
<p>Define jobs in your <code>lefthook.yml</code> file under a specific hook like <code>pre-commit</code>:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - run: yarn lint
    - run: yarn test
</code></pre>
<h3 id="differences-from-commands-and-scripts-1"><a class="header" href="#differences-from-commands-and-scripts-1">Differences from Commands and Scripts</a></h3>
<p><strong>Optional Job Names</strong></p>
<ul>
<li>Named jobs are merged across <a href="configuration/./extends.html"><code>extends</code></a> and local config.</li>
<li>Unnamed jobs are appended in the order of their definition.</li>
</ul>
<p><strong>Job Groups</strong></p>
<ul>
<li>Groups can include other jobs.</li>
<li>Flow within groups can be parallel or piped. Options <code>glob</code>, <code>root</code>, and <code>exclude</code> apply to all jobs in the group, including nested ones.</li>
</ul>
<h3 id="job-options-1"><a class="header" href="#job-options-1">Job options</a></h3>
<p>Below are the available options for configuring jobs.</p>
<ul>
<li><a href="configuration/./name.html"><code>name</code></a></li>
<li><a href="configuration/./run.html"><code>run</code></a></li>
<li><a href="configuration/./script.html"><code>script</code></a></li>
<li><a href="configuration/./runner.html"><code>runner</code></a></li>
<li><a href="configuration/./group.html"><code>group</code></a>
<ul>
<li><a href="configuration/./parallel.html"><code>parallel</code></a></li>
<li><a href="configuration/./piped.html"><code>piped</code></a></li>
<li><a href="configuration/./jobs.html"><code>jobs</code></a></li>
</ul>
</li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./glob.html"><code>glob</code></a></li>
<li><a href="configuration/./files.html"><code>files</code></a></li>
<li><a href="configuration/./file_types.html"><code>file_types</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./root.html"><code>root</code></a></li>
<li><a href="configuration/./exclude.html"><code>exclude</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
</ul>
<h3 id="example-6"><a class="header" href="#example-6">Example</a></h3>
<blockquote>
<p><strong>Note:</strong> Currently, only <code>root</code>, <code>glob</code>, and <code>exclude</code> options are applied to group jobs. Other options must be set for each job individually. Submit a <a href="https://github.com/evilmartians/lefthook/issues/new?assignees=&amp;labels=feature+request&amp;projects=&amp;template=feature_request.md">feature request</a> if this limits your workflow.</p>
</blockquote>
<p>A configuration demonstrating a piped group running in parallel with other jobs:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  parallel: true
  jobs:
    - name: migrate
      root: backend/
      glob: "db/migrations/*"
      group:
        piped: true
        jobs:
          - run: bundle install
          - run: rails db:migrate
    - run: yarn lint --fix {staged_files}
      root: frontend/
      stage_fixed: true
    - run: bundle exec rubocop
      root: backend/
    - run: golangci-lint
      root: proxy/
    - script: verify.sh
      runner: bash
</code></pre>
<p>This configuration runs migrate jobs in a piped flow while other jobs execute in parallel.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="skip-1"><a class="header" href="#skip-1"><code>skip</code></a></h2>
<p>You can skip all or specific commands and scripts using <code>skip</code> option. You can also skip when merging, rebasing, or being on a specific branch. Globs are available for branches.</p>
<p>Possible skip values:</p>
<ul>
<li><code>rebase</code> - when in rebase git state</li>
<li><code>merge</code> - when in merge git state</li>
<li><code>merge-commit</code> - when current HEAD commit is the merge commit</li>
<li><code>ref: main</code> - when on a <code>main</code> branch</li>
<li><code>run: test ${SKIP_ME} -eq 1</code> - when <code>test ${SKIP_ME} -eq 1</code> is successful (return code is 0)</li>
</ul>
<p><strong>Example</strong></p>
<p>Always skipping a command:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: true
      run: yarn lint
</code></pre>
<p>Skipping on merging and rebasing:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip:
        - merge
        - rebase
      run: yarn lint
</code></pre>
<p>Or</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: merge
      run: yarn lint
</code></pre>
<p>Skipping when your are on a merge commit:</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    lint:
      skip: merge-commit
      run: yarn lint
</code></pre>
<p>Skipping the whole hook on <code>main</code> branch:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - ref: main
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>Skipping hook for all <code>dev/*</code> branches:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>Skipping hook by running a command:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - run: test "${NO_HOOK}" -eq 1
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<blockquote>
<p>TIP</p>
<p>Always skipping is useful when you have a <code>lefthook-local.yml</code> config and you don't want to run some commands locally. So you just overwrite the <code>skip</code> option for them to be <code>true</code>.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
</code></pre>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    lint:
      skip: true
</code></pre>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="only-1"><a class="header" href="#only-1"><code>only</code></a></h2>
<p>You can force a command, script, or the whole hook to execute only in certain conditions. This option acts like the opposite of <a href="configuration/./skip.html"><code>skip</code></a>. It accepts the same values but skips execution only if the condition is not satisfied.</p>
<blockquote>
<p><strong>Note:</strong> <code>skip</code> option takes precedence over <code>only</code> option, so if you have conflicting conditions the execution will be skipped.</p>
</blockquote>
<p><strong>Example</strong></p>
<p>Execute a hook only for <code>dev/*</code> branches.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  only:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>When rebasing execute quick linter but skip usual linter and tests.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: rebase
      run: yarn lint
    test:
      skip: rebase
      run: yarn test
    lint-on-rebase:
      only: rebase
      run: yarn lint-quickly
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tags"><a class="header" href="#tags"><code>tags</code></a></h2>
<p>You can specify tags for commands and scripts. This is useful for <a href="configuration/./exclude_tags.html">excluding</a>. You can specify more than one tag using comma.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      tags:
        - frontend
        - js
      run: yarn lint
    test:
      tags:
        - backend
        - ruby
      run: bundle exec rspec
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="glob"><a class="header" href="#glob"><code>glob</code></a></h2>
<p>You can set a glob to filter files for your command. This is only used if you use a file template in <a href="configuration/./run.html"><code>run</code></a> option or provide your custom <a href="configuration/./files.html"><code>files</code></a> command.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - name: lint
      run: yarn eslint {staged_files}
      glob: "*.{js,ts,jsx,tsx}"
</code></pre>
<blockquote>
<p><strong>Note:</strong> from lefthook version <code>1.10.10</code> you can also provide a list of globs:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - run: yarn lint {staged_files}
      glob:
        - "*.ts"
        - "*.js"
</code></pre>
</blockquote>
<p><strong>Notes</strong></p>
<p>For patterns that you can use see <a href="https://tldp.org/LDP/GNU-Linux-Tools-Summary/html/x11655.htm">this</a> reference. We use <a href="https://github.com/gobwas/glob">glob</a> library.</p>
<p><em><strong>When using <code>root:</code></strong></em></p>
<p>Globs are still calculated from the actual root of the git repo, <code>root</code> is ignored.</p>
<p><em><strong>Behaviour of <code>**</code></strong></em></p>
<p>Note that the behaviour of <code>**</code> is different from typical glob implementations, like <code>ls</code> or tools like <code>lint-staged</code> in that a double-asterisk matches 1+ directories deep, not zero or more directories.
If you want to match <em>both</em> files at the top level and nested, then rather than:</p>
<pre><code class="language-yaml">glob: "src/**/*.js"
</code></pre>
<p>You'll need:</p>
<pre><code class="language-yaml">glob: "src/*.js"
</code></pre>
<p><em><strong>Using <code>glob</code> without a files template in<code>run</code></strong></em></p>
<p>If you've specified <code>glob</code> but don't have a files template in <a href="configuration/./run.html"><code>run</code></a> option, lefthook will check <code>{staged_files}</code> for <code>pre-commit</code> hook and <code>{push_files}</code> for <code>pre-push</code> hook and apply filtering. If no files left, the command will be skipped.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - name: lint
      run: npm run lint # skipped if no .js files staged
      glob: "*.js"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="files"><a class="header" href="#files"><code>files</code></a></h2>
<p>A custom git command for files or directories to be referenced in <code>{files}</code> template for <a href="configuration/./run.html"><code>run</code></a> setting.</p>
<p>If the result of this command is empty, the execution of commands will be skipped.</p>
<p>This option overwrites the <a href="configuration/./files-global.html">hook-level <code>files</code></a> option.</p>
<p><strong>Example</strong></p>
<p>Provide a git command to list files.</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    stylelint:
      tags:
        - frontend
        - style
      files: git diff --name-only master
      glob: "*.js"
      run: yarn stylelint {files}
</code></pre>
<p>Call a custom script for listing files.</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    rubocop:
      tags: backend
      glob: "**/*.rb"
      files: node ./lefthook-scripts/ls-files.js # you can call your own scripts
      run: bundle exec rubocop --force-exclusion --parallel {files}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="file_types"><a class="header" href="#file_types"><code>file_types</code></a></h2>
<p>Filter files in a <a href="configuration/./run.html"><code>run</code></a> templates by their type. Supported types:</p>
<div class="table-wrapper"><table><thead><tr><th>File type</th><th>Exlanation</th></tr></thead><tbody>
<tr><td><code>text</code></td><td>Any file that contains text. Symlinks are not followed.</td></tr>
<tr><td><code>binary</code></td><td>Any file that contains non-text bytes. Symlinks are not followed.</td></tr>
<tr><td><code>executable</code></td><td>Any file that has executable bits set. Symlinks are not followed.</td></tr>
<tr><td><code>not executable</code></td><td>Any file without executable bits in file mode. Symlinks included.</td></tr>
<tr><td><code>symlink</code></td><td>A symlink file.</td></tr>
<tr><td><code>not symlink</code></td><td>Any non-symlink file.</td></tr>
</tbody></table>
</div>
<blockquote>
<p><strong>Important:</strong> When passed multiple file types all constraints will be applied to the resulting list of files</p>
</blockquote>
<p><strong>Examples</strong></p>
<p>Apply some different linters on text and binary files.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint-code:
      run: yarn lint {staged_files}
      file_types: text
    check-hex-codes:
      run: yarn check-hex {staged_files}
      file_types: binary
</code></pre>
<p>Skip symlinks.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint --fix {staged_files}
      file_types:
        - not symlink
</code></pre>
<p>Lint executable scripts.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint --fix {staged_files}
      file_types:
        - executable
        - text
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="env"><a class="header" href="#env"><code>env</code></a></h2>
<p>You can specify some ENV variables for the command or script.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    test:
      env:
        RAILS_ENV: test
      run: bundle exec rspec
</code></pre>
<h4 id="extending-path"><a class="header" href="#extending-path">Extending PATH</a></h4>
<p>If your hook is run by GUI program, and you use some PATH tweaks in your ~/.<shell>rc, you might see an error saying <em>executable not found</em>. In that case You can extend the <strong>$PATH</strong> variable with <code>lefthook-local.yml</code> configuration the following way.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    test:
      run: yarn test
</code></pre>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    test:
      env:
        PATH: $PATH:/home/me/path/to/yarn
</code></pre>
<p><strong>Notes</strong></p>
<p>This option is useful when using lefthook on different OSes or shells where ENV variables are set in different ways.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="root"><a class="header" href="#root"><code>root</code></a></h2>
<p>You can change the CWD for the command you execute using <code>root</code> option.</p>
<p>This is useful when you execute some <code>npm</code> or <code>yarn</code> command but the <code>package.json</code> is in another directory.</p>
<p>For <code>pre-push</code> and <code>pre-commit</code> hooks and for the custom <code>files</code> command <code>root</code> option is used to filter file paths. If all files are filtered the command will be skipped.</p>
<p><strong>Example</strong></p>
<p>Format and stage files from a <code>client/</code> folder.</p>
<pre><code class="language-bash"># Folders structure

$ tree .
.
‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ node_modules/
|   ‚îú‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ server/
|   ...
</code></pre>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      root: "client/"
      glob: "*.{js,ts}"
      run: yarn eslint --fix {staged_files} &amp;&amp; git add {staged_files}
</code></pre>
<p><strong>Notes</strong></p>
<p><em><strong>When using <code>root:</code></strong></em></p>
<p>Globs are still calculated from the actual root of the git repo, <code>root</code> is ignored.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="exclude"><a class="header" href="#exclude"><code>exclude</code></a></h2>
<p>For the <code>exclude</code> option two variants are supported:</p>
<ul>
<li>A list of globs to be excluded</li>
<li>A single regular expression (deprecated)</li>
</ul>
<blockquote>
<p><strong>Note:</strong> The regular expression is matched against full paths to files in the repo,
relative to the repo root, using <code>/</code> as the directory separator on all platforms.
File paths do not begin with the separator or any other prefix.</p>
</blockquote>
<p><strong>Example</strong></p>
<p>Run Rubocop on staged files with <code>.rb</code> extension except for <code>application.rb</code>, <code>routes.rb</code>, <code>rails_helper.rb</code>, and all Ruby files in <code>config/initializers/</code>.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      glob: "*.rb"
      exclude:
        - config/routes.rb
        - config/application.rb
        - config/initializers/*.rb
        - spec/rails_helper.rb
      run: bundle exec rubocop --force-exclusion {staged_files}
</code></pre>
<p>The same example using a regular expression.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      glob: "*.rb"
      exclude: '(^|/)(application|routes|rails_helper|initializers/\w+)\.rb$'
      run: bundle exec rubocop --force-exclusion {staged_files}
</code></pre>
<p><strong>Important</strong></p>
<p>Be careful with the config file format's string quoting and escaping rules when writing regexps in it. For YAML, single quotes are often the simplest choice.</p>
<p>If you've specified <code>exclude</code> but don't have a files template in <a href="configuration/./run.html"><code>run</code></a> option, lefthook will check <code>{staged_files}</code> for <code>pre-commit</code> hook and <code>{push_files}</code> for <code>pre-push</code> hook and apply filtering. If no files left, the command will be skipped.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      exclude: '(^|/)application\.rb$'
      run: bundle exec rubocop # skipped if only application.rb was staged
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="fail_text"><a class="header" href="#fail_text"><code>fail_text</code></a></h2>
<p>You can specify a text to show when the command or script fails.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
      fail_text: Add node executable to $PATH
</code></pre>
<pre><code class="language-bash">$ git commit -m 'fix: Some bug'

Lefthook v1.1.3
RUNNING HOOK: pre-commit

  EXECUTE &gt; lint

SUMMARY: (done in 0.01 seconds)
ü•ä  lint: Add node executable to $PATH env
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="stage_fixed"><a class="header" href="#stage_fixed"><code>stage_fixed</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p>Works <strong>only for <code>pre-commit</code></strong> hook</p>
</blockquote>
<p>When set to <code>true</code> lefthook will automatically call <code>git add</code> on files after running the command or script. For a command if <a href="configuration/./files.html"><code>files</code></a> option was specified, the specified command will be used to retrieve files for <code>git add</code>. For scripts and commands without <a href="configuration/./files.html"><code>files</code></a> option <code>{staged_files}</code> template will be used. All filters (<a href="configuration/./glob.html"><code>glob</code></a>, <a href="configuration/./exclude.html"><code>exclude</code></a>) will be applied if specified.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: npm run lint --fix {staged_files}
      stage_fixed: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="interactive"><a class="header" href="#interactive"><code>interactive</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p><strong>Note:</strong> If you want to pass stdin to your command or script but don't need to get the input from CLI, use <a href="configuration/./use_stdin.html"><code>use_stdin</code></a> option instead.</p>
</blockquote>
<p>Whether to use interactive mode. This applies the certain behavior:</p>
<ul>
<li>All <code>interactive</code> commands/scripts are executed after non-interactive. Exception: <a href="configuration/./piped.html"><code>piped</code></a> option is set to <code>true</code>.</li>
<li>When executing, lefthook tries to open /dev/tty (Linux/Unix only) and use it as stdin.</li>
<li>When <a href="configuration/./no_tty.html"><code>no_tty</code></a> option is set, <code>interactive</code> is ignored.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="use_stdin"><a class="header" href="#use_stdin"><code>use_stdin</code></a></h2>
<blockquote>
<p><strong>Note:</strong> With many commands or scripts having <code>use_stdin: true</code>, only one will receive the data. The others will have nothing. If you need to pass the data from stdin to every command or script, please, submit a <a href="https://github.com/evilmartians/lefthook/issues/new?assignees=&amp;labels=feature+request&amp;projects=&amp;template=feature_request.md">feature request</a>.</p>
</blockquote>
<p>Pass the stdin from the OS to the command/script.</p>
<p><strong>Example</strong></p>
<p>Use this option for the <code>pre-push</code> hook when you have a script that does <code>while read ...</code>. Without this option lefthook will hang: lefthook uses <a href="https://github.com/creack/pty">pseudo TTY</a> by default, and it doesn't close stdin when all data is read.</p>
<pre><code class="language-bash"># .lefthook/pre-push/do-the-magic.sh

remote="$1"
url="$2"

while read local_ref local_oid remote_ref remote_oid; do
  # ...
done
</code></pre>
<pre><code class="language-yml"># lefthook.yml
pre-push:
  scripts:
    "do-the-magic.sh":
      runner: bash
      use_stdin: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="commands-1"><a class="header" href="#commands-1"><code>commands</code></a></h2>
<p>Commands to be executed for the hook. Each command has a name and associated run <a href="configuration/Commands.html#command">options</a>.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      ... # command options
</code></pre>
<h3 id="command-options"><a class="header" href="#command-options">Command options</a></h3>
<ul>
<li><a href="configuration/./run.html"><code>run</code></a></li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./glob.html"><code>glob</code></a></li>
<li><a href="configuration/./files.html"><code>files</code></a></li>
<li><a href="configuration/./file_types.html"><code>file_types</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./root.html"><code>root</code></a></li>
<li><a href="configuration/./exclude.html"><code>exclude</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
<li><a href="configuration/./priority.html"><code>priority</code></a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="run-1"><a class="header" href="#run-1"><code>run</code></a></h2>
<blockquote>
<p><strong>Note:</strong> <code>run</code> command is treated differently on Unix-like systems (macOS, Linux) and Windows:</p>
<ul>
<li>*<strong>nix</strong>: commands get wrapped with <code>sh -c '&lt;run&gt;'</code></li>
<li><strong>Windows</strong>: commands execute natively</li>
</ul>
<p>So, when on *nix systems you can use pipes, builtins of a Bourne Shell, etc. For Windows the capabilities are limited by a single command.</p>
</blockquote>
<p>This is a mandatory option for a command. This is actually a command that is executed for the hook.</p>
<p>You can use files templates that will be substituted with the appropriate files on execution:</p>
<ul>
<li><code>{files}</code> - custom <a href="configuration/./files.html"><code>files</code></a> command result.</li>
<li><code>{staged_files}</code> - staged files which you try to commit.</li>
<li><code>{push_files}</code> - files that are committed but not pushed.</li>
<li><code>{all_files}</code> - all files tracked by git.</li>
<li><code>{cmd}</code> - shorthand for the command from <code>lefthook.yml</code>.</li>
<li><code>{0}</code> - shorthand for the single space-joint string of git hook arguments.</li>
<li><code>{N}</code> - shorthand for the N-th git hook argument.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> Command line length has a limit on every system. If your list of files is quite long, lefthook splits your files list to fit in the limit and runs few commands sequentially.</p>
</blockquote>
<p><strong>Example</strong></p>
<p>Run <code>yarn lint</code> on <code>pre-commit</code> hook.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
</code></pre>
<h4 id="files-template-1"><a class="header" href="#files-template-1"><code>{files}</code> template</a></h4>
<p>Run <code>go vet</code> only on files listed with <code>git ls-files -m</code> command with <code>.go</code> extension.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    govet:
      files: git ls-files -m
      glob: "*.go"
      run: go vet {files}
</code></pre>
<h4 id="staged_files-template-1"><a class="header" href="#staged_files-template-1"><code>{staged_files}</code> template</a></h4>
<p>Run <code>yarn eslint</code> only on staged files with <code>.js</code>, <code>.ts</code>, <code>.jsx</code>, and <code>.tsx</code> extensions.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    eslint:
      glob: "*.{js,ts,jsx,tsx}"
      run: yarn eslint {staged_files}
</code></pre>
<h4 id="push_files-template-1"><a class="header" href="#push_files-template-1"><code>{push_files}</code> template</a></h4>
<p>If you want to lint files only before pushing them.</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    eslint:
      glob: "*.{js,ts,jsx,tsx}"
      run: yarn eslint {push_files}
</code></pre>
<h4 id="all_files-template-1"><a class="header" href="#all_files-template-1"><code>{all_files}</code> template</a></h4>
<p>Simply run <code>bundle exec rubocop</code> on all files with <code>.rb</code> extension excluding <code>application.rb</code> and <code>routes.rb</code> files.</p>
<blockquote>
<p><strong>Note:</strong> <code>--force-exclusion</code> will apply <code>Exclude</code> configuration setting of Rubocop</p>
</blockquote>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    rubocop:
      tags:
        - backend
        - style
      glob: "*.rb"
      exclude:
        - config/application.rb
        - config/routes.rb
      run: bundle exec rubocop --force-exclusion {all_files}
</code></pre>
<h4 id="cmd-template-1"><a class="header" href="#cmd-template-1"><code>{cmd}</code> template</a></h4>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
  scripts:
    "good_job.js":
      runner: node
</code></pre>
<p>You can wrap it in docker runner locally:</p>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    lint:
      run: docker run -it --rm &lt;container_id_or_name&gt; {cmd}
  scripts:
    "good_job.js":
      runner: docker run -it --rm &lt;container_id_or_name&gt; {cmd}
</code></pre>
<h4 id="git-arguments-1"><a class="header" href="#git-arguments-1">Git arguments</a></h4>
<p>Make sure commits are signed.</p>
<pre><code class="language-yml"># lefthook.yml

# Note: commit-msg hook takes a single parameter,
#       the name of the file that holds the proposed commit log message.
# Source: https://git-scm.com/docs/githooks#_commit_msg
commit-msg:
  commands:
    multiple-sign-off:
      run: 'test $(grep -c "^Signed-off-by: " {1}) -lt 2'
</code></pre>
<h4 id="rubocop-1"><a class="header" href="#rubocop-1">Rubocop</a></h4>
<p>If using <code>{all_files}</code> with RuboCop, it will ignore RuboCop's <code>Exclude</code> configuration setting. To avoid this, pass <code>--force-exclusion</code>.</p>
<h4 id="quotes-1"><a class="header" href="#quotes-1">Quotes</a></h4>
<p>If you want to have all your files quoted with double quotes <code>"</code> or single quotes <code>'</code>, quote the appropriate shorthand:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      glob: "*.js"
      # Quoting with double quotes `"` might be helpful for Windows users
      run: yarn eslint "{staged_files}" # will run `yarn eslint "file1.js" "file2.js" "[strange name].js"`
    test:
      glob: "*.{spec.js}"
      run: yarn test '{staged_files}' # will run `yarn eslint 'file1.spec.js' 'file2.spec.js' '[strange name].spec.js'`
    format:
      glob: "*.js"
      # Will quote where needed with single quotes
      run: yarn test {staged_files} # will run `yarn eslint file1.js file2.js '[strange name].spec.js'`
</code></pre>
<h4 id="scripts-1"><a class="header" href="#scripts-1">Scripts</a></h4>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - name: a whole script in a run
      run: |
        for file in $(ls .); do
          yarn lint $file
        done
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="skip-2"><a class="header" href="#skip-2"><code>skip</code></a></h2>
<p>You can skip all or specific commands and scripts using <code>skip</code> option. You can also skip when merging, rebasing, or being on a specific branch. Globs are available for branches.</p>
<p>Possible skip values:</p>
<ul>
<li><code>rebase</code> - when in rebase git state</li>
<li><code>merge</code> - when in merge git state</li>
<li><code>merge-commit</code> - when current HEAD commit is the merge commit</li>
<li><code>ref: main</code> - when on a <code>main</code> branch</li>
<li><code>run: test ${SKIP_ME} -eq 1</code> - when <code>test ${SKIP_ME} -eq 1</code> is successful (return code is 0)</li>
</ul>
<p><strong>Example</strong></p>
<p>Always skipping a command:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: true
      run: yarn lint
</code></pre>
<p>Skipping on merging and rebasing:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip:
        - merge
        - rebase
      run: yarn lint
</code></pre>
<p>Or</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: merge
      run: yarn lint
</code></pre>
<p>Skipping when your are on a merge commit:</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    lint:
      skip: merge-commit
      run: yarn lint
</code></pre>
<p>Skipping the whole hook on <code>main</code> branch:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - ref: main
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>Skipping hook for all <code>dev/*</code> branches:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>Skipping hook by running a command:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - run: test "${NO_HOOK}" -eq 1
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<blockquote>
<p>TIP</p>
<p>Always skipping is useful when you have a <code>lefthook-local.yml</code> config and you don't want to run some commands locally. So you just overwrite the <code>skip</code> option for them to be <code>true</code>.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
</code></pre>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    lint:
      skip: true
</code></pre>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="only-2"><a class="header" href="#only-2"><code>only</code></a></h2>
<p>You can force a command, script, or the whole hook to execute only in certain conditions. This option acts like the opposite of <a href="configuration/./skip.html"><code>skip</code></a>. It accepts the same values but skips execution only if the condition is not satisfied.</p>
<blockquote>
<p><strong>Note:</strong> <code>skip</code> option takes precedence over <code>only</code> option, so if you have conflicting conditions the execution will be skipped.</p>
</blockquote>
<p><strong>Example</strong></p>
<p>Execute a hook only for <code>dev/*</code> branches.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  only:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>When rebasing execute quick linter but skip usual linter and tests.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: rebase
      run: yarn lint
    test:
      skip: rebase
      run: yarn test
    lint-on-rebase:
      only: rebase
      run: yarn lint-quickly
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tags-1"><a class="header" href="#tags-1"><code>tags</code></a></h2>
<p>You can specify tags for commands and scripts. This is useful for <a href="configuration/./exclude_tags.html">excluding</a>. You can specify more than one tag using comma.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      tags:
        - frontend
        - js
      run: yarn lint
    test:
      tags:
        - backend
        - ruby
      run: bundle exec rspec
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="glob-1"><a class="header" href="#glob-1"><code>glob</code></a></h2>
<p>You can set a glob to filter files for your command. This is only used if you use a file template in <a href="configuration/./run.html"><code>run</code></a> option or provide your custom <a href="configuration/./files.html"><code>files</code></a> command.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - name: lint
      run: yarn eslint {staged_files}
      glob: "*.{js,ts,jsx,tsx}"
</code></pre>
<blockquote>
<p><strong>Note:</strong> from lefthook version <code>1.10.10</code> you can also provide a list of globs:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - run: yarn lint {staged_files}
      glob:
        - "*.ts"
        - "*.js"
</code></pre>
</blockquote>
<p><strong>Notes</strong></p>
<p>For patterns that you can use see <a href="https://tldp.org/LDP/GNU-Linux-Tools-Summary/html/x11655.htm">this</a> reference. We use <a href="https://github.com/gobwas/glob">glob</a> library.</p>
<p><em><strong>When using <code>root:</code></strong></em></p>
<p>Globs are still calculated from the actual root of the git repo, <code>root</code> is ignored.</p>
<p><em><strong>Behaviour of <code>**</code></strong></em></p>
<p>Note that the behaviour of <code>**</code> is different from typical glob implementations, like <code>ls</code> or tools like <code>lint-staged</code> in that a double-asterisk matches 1+ directories deep, not zero or more directories.
If you want to match <em>both</em> files at the top level and nested, then rather than:</p>
<pre><code class="language-yaml">glob: "src/**/*.js"
</code></pre>
<p>You'll need:</p>
<pre><code class="language-yaml">glob: "src/*.js"
</code></pre>
<p><em><strong>Using <code>glob</code> without a files template in<code>run</code></strong></em></p>
<p>If you've specified <code>glob</code> but don't have a files template in <a href="configuration/./run.html"><code>run</code></a> option, lefthook will check <code>{staged_files}</code> for <code>pre-commit</code> hook and <code>{push_files}</code> for <code>pre-push</code> hook and apply filtering. If no files left, the command will be skipped.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  jobs:
    - name: lint
      run: npm run lint # skipped if no .js files staged
      glob: "*.js"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="files-1"><a class="header" href="#files-1"><code>files</code></a></h2>
<p>A custom git command for files or directories to be referenced in <code>{files}</code> template for <a href="configuration/./run.html"><code>run</code></a> setting.</p>
<p>If the result of this command is empty, the execution of commands will be skipped.</p>
<p>This option overwrites the <a href="configuration/./files-global.html">hook-level <code>files</code></a> option.</p>
<p><strong>Example</strong></p>
<p>Provide a git command to list files.</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    stylelint:
      tags:
        - frontend
        - style
      files: git diff --name-only master
      glob: "*.js"
      run: yarn stylelint {files}
</code></pre>
<p>Call a custom script for listing files.</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    rubocop:
      tags: backend
      glob: "**/*.rb"
      files: node ./lefthook-scripts/ls-files.js # you can call your own scripts
      run: bundle exec rubocop --force-exclusion --parallel {files}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="file_types-1"><a class="header" href="#file_types-1"><code>file_types</code></a></h2>
<p>Filter files in a <a href="configuration/./run.html"><code>run</code></a> templates by their type. Supported types:</p>
<div class="table-wrapper"><table><thead><tr><th>File type</th><th>Exlanation</th></tr></thead><tbody>
<tr><td><code>text</code></td><td>Any file that contains text. Symlinks are not followed.</td></tr>
<tr><td><code>binary</code></td><td>Any file that contains non-text bytes. Symlinks are not followed.</td></tr>
<tr><td><code>executable</code></td><td>Any file that has executable bits set. Symlinks are not followed.</td></tr>
<tr><td><code>not executable</code></td><td>Any file without executable bits in file mode. Symlinks included.</td></tr>
<tr><td><code>symlink</code></td><td>A symlink file.</td></tr>
<tr><td><code>not symlink</code></td><td>Any non-symlink file.</td></tr>
</tbody></table>
</div>
<blockquote>
<p><strong>Important:</strong> When passed multiple file types all constraints will be applied to the resulting list of files</p>
</blockquote>
<p><strong>Examples</strong></p>
<p>Apply some different linters on text and binary files.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint-code:
      run: yarn lint {staged_files}
      file_types: text
    check-hex-codes:
      run: yarn check-hex {staged_files}
      file_types: binary
</code></pre>
<p>Skip symlinks.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint --fix {staged_files}
      file_types:
        - not symlink
</code></pre>
<p>Lint executable scripts.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint --fix {staged_files}
      file_types:
        - executable
        - text
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="env-1"><a class="header" href="#env-1"><code>env</code></a></h2>
<p>You can specify some ENV variables for the command or script.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    test:
      env:
        RAILS_ENV: test
      run: bundle exec rspec
</code></pre>
<h4 id="extending-path-1"><a class="header" href="#extending-path-1">Extending PATH</a></h4>
<p>If your hook is run by GUI program, and you use some PATH tweaks in your ~/.<shell>rc, you might see an error saying <em>executable not found</em>. In that case You can extend the <strong>$PATH</strong> variable with <code>lefthook-local.yml</code> configuration the following way.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    test:
      run: yarn test
</code></pre>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    test:
      env:
        PATH: $PATH:/home/me/path/to/yarn
</code></pre>
<p><strong>Notes</strong></p>
<p>This option is useful when using lefthook on different OSes or shells where ENV variables are set in different ways.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="root-1"><a class="header" href="#root-1"><code>root</code></a></h2>
<p>You can change the CWD for the command you execute using <code>root</code> option.</p>
<p>This is useful when you execute some <code>npm</code> or <code>yarn</code> command but the <code>package.json</code> is in another directory.</p>
<p>For <code>pre-push</code> and <code>pre-commit</code> hooks and for the custom <code>files</code> command <code>root</code> option is used to filter file paths. If all files are filtered the command will be skipped.</p>
<p><strong>Example</strong></p>
<p>Format and stage files from a <code>client/</code> folder.</p>
<pre><code class="language-bash"># Folders structure

$ tree .
.
‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îú‚îÄ‚îÄ package.json
‚îÇ   ‚îú‚îÄ‚îÄ node_modules/
|   ‚îú‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ server/
|   ...
</code></pre>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      root: "client/"
      glob: "*.{js,ts}"
      run: yarn eslint --fix {staged_files} &amp;&amp; git add {staged_files}
</code></pre>
<p><strong>Notes</strong></p>
<p><em><strong>When using <code>root:</code></strong></em></p>
<p>Globs are still calculated from the actual root of the git repo, <code>root</code> is ignored.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="exclude-1"><a class="header" href="#exclude-1"><code>exclude</code></a></h2>
<p>For the <code>exclude</code> option two variants are supported:</p>
<ul>
<li>A list of globs to be excluded</li>
<li>A single regular expression (deprecated)</li>
</ul>
<blockquote>
<p><strong>Note:</strong> The regular expression is matched against full paths to files in the repo,
relative to the repo root, using <code>/</code> as the directory separator on all platforms.
File paths do not begin with the separator or any other prefix.</p>
</blockquote>
<p><strong>Example</strong></p>
<p>Run Rubocop on staged files with <code>.rb</code> extension except for <code>application.rb</code>, <code>routes.rb</code>, <code>rails_helper.rb</code>, and all Ruby files in <code>config/initializers/</code>.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      glob: "*.rb"
      exclude:
        - config/routes.rb
        - config/application.rb
        - config/initializers/*.rb
        - spec/rails_helper.rb
      run: bundle exec rubocop --force-exclusion {staged_files}
</code></pre>
<p>The same example using a regular expression.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      glob: "*.rb"
      exclude: '(^|/)(application|routes|rails_helper|initializers/\w+)\.rb$'
      run: bundle exec rubocop --force-exclusion {staged_files}
</code></pre>
<p><strong>Important</strong></p>
<p>Be careful with the config file format's string quoting and escaping rules when writing regexps in it. For YAML, single quotes are often the simplest choice.</p>
<p>If you've specified <code>exclude</code> but don't have a files template in <a href="configuration/./run.html"><code>run</code></a> option, lefthook will check <code>{staged_files}</code> for <code>pre-commit</code> hook and <code>{push_files}</code> for <code>pre-push</code> hook and apply filtering. If no files left, the command will be skipped.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      exclude: '(^|/)application\.rb$'
      run: bundle exec rubocop # skipped if only application.rb was staged
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="fail_text-1"><a class="header" href="#fail_text-1"><code>fail_text</code></a></h2>
<p>You can specify a text to show when the command or script fails.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
      fail_text: Add node executable to $PATH
</code></pre>
<pre><code class="language-bash">$ git commit -m 'fix: Some bug'

Lefthook v1.1.3
RUNNING HOOK: pre-commit

  EXECUTE &gt; lint

SUMMARY: (done in 0.01 seconds)
ü•ä  lint: Add node executable to $PATH env
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="stage_fixed-1"><a class="header" href="#stage_fixed-1"><code>stage_fixed</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p>Works <strong>only for <code>pre-commit</code></strong> hook</p>
</blockquote>
<p>When set to <code>true</code> lefthook will automatically call <code>git add</code> on files after running the command or script. For a command if <a href="configuration/./files.html"><code>files</code></a> option was specified, the specified command will be used to retrieve files for <code>git add</code>. For scripts and commands without <a href="configuration/./files.html"><code>files</code></a> option <code>{staged_files}</code> template will be used. All filters (<a href="configuration/./glob.html"><code>glob</code></a>, <a href="configuration/./exclude.html"><code>exclude</code></a>) will be applied if specified.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: npm run lint --fix {staged_files}
      stage_fixed: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="interactive-1"><a class="header" href="#interactive-1"><code>interactive</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p><strong>Note:</strong> If you want to pass stdin to your command or script but don't need to get the input from CLI, use <a href="configuration/./use_stdin.html"><code>use_stdin</code></a> option instead.</p>
</blockquote>
<p>Whether to use interactive mode. This applies the certain behavior:</p>
<ul>
<li>All <code>interactive</code> commands/scripts are executed after non-interactive. Exception: <a href="configuration/./piped.html"><code>piped</code></a> option is set to <code>true</code>.</li>
<li>When executing, lefthook tries to open /dev/tty (Linux/Unix only) and use it as stdin.</li>
<li>When <a href="configuration/./no_tty.html"><code>no_tty</code></a> option is set, <code>interactive</code> is ignored.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="use_stdin-1"><a class="header" href="#use_stdin-1"><code>use_stdin</code></a></h2>
<blockquote>
<p><strong>Note:</strong> With many commands or scripts having <code>use_stdin: true</code>, only one will receive the data. The others will have nothing. If you need to pass the data from stdin to every command or script, please, submit a <a href="https://github.com/evilmartians/lefthook/issues/new?assignees=&amp;labels=feature+request&amp;projects=&amp;template=feature_request.md">feature request</a>.</p>
</blockquote>
<p>Pass the stdin from the OS to the command/script.</p>
<p><strong>Example</strong></p>
<p>Use this option for the <code>pre-push</code> hook when you have a script that does <code>while read ...</code>. Without this option lefthook will hang: lefthook uses <a href="https://github.com/creack/pty">pseudo TTY</a> by default, and it doesn't close stdin when all data is read.</p>
<pre><code class="language-bash"># .lefthook/pre-push/do-the-magic.sh

remote="$1"
url="$2"

while read local_ref local_oid remote_ref remote_oid; do
  # ...
done
</code></pre>
<pre><code class="language-yml"># lefthook.yml
pre-push:
  scripts:
    "do-the-magic.sh":
      runner: bash
      use_stdin: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="priority"><a class="header" href="#priority"><code>priority</code></a></h2>
<p><strong>Default: <code>0</code></strong></p>
<blockquote>
<p><strong>Note:</strong> This option makes sense only when <code>parallel: false</code> or <code>piped: true</code> is set.</p>
<p>Value <code>0</code> is considered an <code>+Infinity</code>, so commands or scripts with <code>priority: 0</code> or without this setting will be run at the very end.</p>
</blockquote>
<p>Set priority from 1 to +Infinity. This option can be used to configure the order of the sequential steps.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

post-checkout:
  piped: true
  commands:
    db-create:
      priority: 1
      run: rails db:create
    db-migrate:
      priority: 2
      run: rails db:migrate
    db-seed:
      priority: 3
      run: rails db:seed

  scripts:
    "check-spelling.sh":
      runner: bash
      priority: 1
    "check-grammar.rb":
      runner: ruby
      priority: 2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="scripts-2"><a class="header" href="#scripts-2">Scripts</a></h2>
<p>Scripts are stored under <code>&lt;source_dir&gt;/&lt;hook-name&gt;/</code> folder. These scripts are your own executables which are being run in the project root.</p>
<p>To add a script for a <code>pre-commit</code> hook:</p>
<ol>
<li>Run <code>lefthook add -d pre-commit</code></li>
<li>Edit <code>.lefthook/pre-commit/my-script.sh</code></li>
<li>Add an entry to <code>lefthook.yml</code>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  scripts:
    "my-script.sh":
      runner: bash
</code></pre>
</li>
</ol>
<h3 id="script-options"><a class="header" href="#script-options">Script options</a></h3>
<ul>
<li><a href="configuration/./runner.html"><code>runner</code></a></li>
<li><a href="configuration/./skip.html"><code>skip</code></a></li>
<li><a href="configuration/./only.html"><code>only</code></a></li>
<li><a href="configuration/./tags.html"><code>tags</code></a></li>
<li><a href="configuration/./env.html"><code>env</code></a></li>
<li><a href="configuration/./fail_text.html"><code>fail_text</code></a></li>
<li><a href="configuration/./stage_fixed.html"><code>stage_fixed</code></a></li>
<li><a href="configuration/./interactive.html"><code>interactive</code></a></li>
<li><a href="configuration/./use_stdin.html"><code>use_stdin</code></a></li>
<li><a href="configuration/./priority.html"><code>priority</code></a></li>
</ul>
<h3 id="example-7"><a class="header" href="#example-7">Example</a></h3>
<p>Let's create a bash script to check commit templates <code>.lefthook/commit-msg/template_checker</code>:</p>
<pre><code class="language-bash">INPUT_FILE=$1
START_LINE=`head -n1 $INPUT_FILE`
PATTERN="^(TICKET)-[[:digit:]]+: "
if ! [[ "$START_LINE" =~ $PATTERN ]]; then
  echo "Bad commit message, see example: TICKET-123: some text"
  exit 1
fi
</code></pre>
<p>Now we can ask lefthook to run our bash script by adding this code to
<code>lefthook.yml</code> file:</p>
<pre><code class="language-yml"># lefthook.yml

commit-msg:
  scripts:
    "template_checker":
      runner: bash
</code></pre>
<p>When you try to commit <code>git commit -m "bad commit text"</code> script <code>template_checker</code> will be executed. Since commit text doesn't match the described pattern the commit process will be interrupted.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="runner-1"><a class="header" href="#runner-1"><code>runner</code></a></h2>
<p>You should specify a runner for the script. This is a command that should execute a script file. It will be called the following way: <code>&lt;runner&gt; &lt;path-to-script&gt;</code> (e.g. <code>ruby .lefthook/pre-commit/lint.rb</code>).</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  scripts:
    "lint.js":
      runner: node
    "check.go":
      runner: go run
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="skip-3"><a class="header" href="#skip-3"><code>skip</code></a></h2>
<p>You can skip all or specific commands and scripts using <code>skip</code> option. You can also skip when merging, rebasing, or being on a specific branch. Globs are available for branches.</p>
<p>Possible skip values:</p>
<ul>
<li><code>rebase</code> - when in rebase git state</li>
<li><code>merge</code> - when in merge git state</li>
<li><code>merge-commit</code> - when current HEAD commit is the merge commit</li>
<li><code>ref: main</code> - when on a <code>main</code> branch</li>
<li><code>run: test ${SKIP_ME} -eq 1</code> - when <code>test ${SKIP_ME} -eq 1</code> is successful (return code is 0)</li>
</ul>
<p><strong>Example</strong></p>
<p>Always skipping a command:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: true
      run: yarn lint
</code></pre>
<p>Skipping on merging and rebasing:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip:
        - merge
        - rebase
      run: yarn lint
</code></pre>
<p>Or</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: merge
      run: yarn lint
</code></pre>
<p>Skipping when your are on a merge commit:</p>
<pre><code class="language-yml"># lefthook.yml

pre-push:
  commands:
    lint:
      skip: merge-commit
      run: yarn lint
</code></pre>
<p>Skipping the whole hook on <code>main</code> branch:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - ref: main
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>Skipping hook for all <code>dev/*</code> branches:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>Skipping hook by running a command:</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  skip:
    - run: test "${NO_HOOK}" -eq 1
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<blockquote>
<p>TIP</p>
<p>Always skipping is useful when you have a <code>lefthook-local.yml</code> config and you don't want to run some commands locally. So you just overwrite the <code>skip</code> option for them to be <code>true</code>.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
</code></pre>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    lint:
      skip: true
</code></pre>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><h2 id="only-3"><a class="header" href="#only-3"><code>only</code></a></h2>
<p>You can force a command, script, or the whole hook to execute only in certain conditions. This option acts like the opposite of <a href="configuration/./skip.html"><code>skip</code></a>. It accepts the same values but skips execution only if the condition is not satisfied.</p>
<blockquote>
<p><strong>Note:</strong> <code>skip</code> option takes precedence over <code>only</code> option, so if you have conflicting conditions the execution will be skipped.</p>
</blockquote>
<p><strong>Example</strong></p>
<p>Execute a hook only for <code>dev/*</code> branches.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  only:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint
    test:
      run: yarn test
</code></pre>
<p>When rebasing execute quick linter but skip usual linter and tests.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      skip: rebase
      run: yarn lint
    test:
      skip: rebase
      run: yarn test
    lint-on-rebase:
      only: rebase
      run: yarn lint-quickly
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="tags-2"><a class="header" href="#tags-2"><code>tags</code></a></h2>
<p>You can specify tags for commands and scripts. This is useful for <a href="configuration/./exclude_tags.html">excluding</a>. You can specify more than one tag using comma.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      tags:
        - frontend
        - js
      run: yarn lint
    test:
      tags:
        - backend
        - ruby
      run: bundle exec rspec
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="env-2"><a class="header" href="#env-2"><code>env</code></a></h2>
<p>You can specify some ENV variables for the command or script.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    test:
      env:
        RAILS_ENV: test
      run: bundle exec rspec
</code></pre>
<h4 id="extending-path-2"><a class="header" href="#extending-path-2">Extending PATH</a></h4>
<p>If your hook is run by GUI program, and you use some PATH tweaks in your ~/.<shell>rc, you might see an error saying <em>executable not found</em>. In that case You can extend the <strong>$PATH</strong> variable with <code>lefthook-local.yml</code> configuration the following way.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    test:
      run: yarn test
</code></pre>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  commands:
    test:
      env:
        PATH: $PATH:/home/me/path/to/yarn
</code></pre>
<p><strong>Notes</strong></p>
<p>This option is useful when using lefthook on different OSes or shells where ENV variables are set in different ways.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="fail_text-2"><a class="header" href="#fail_text-2"><code>fail_text</code></a></h2>
<p>You can specify a text to show when the command or script fails.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint
      fail_text: Add node executable to $PATH
</code></pre>
<pre><code class="language-bash">$ git commit -m 'fix: Some bug'

Lefthook v1.1.3
RUNNING HOOK: pre-commit

  EXECUTE &gt; lint

SUMMARY: (done in 0.01 seconds)
ü•ä  lint: Add node executable to $PATH env
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="stage_fixed-2"><a class="header" href="#stage_fixed-2"><code>stage_fixed</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p>Works <strong>only for <code>pre-commit</code></strong> hook</p>
</blockquote>
<p>When set to <code>true</code> lefthook will automatically call <code>git add</code> on files after running the command or script. For a command if <a href="configuration/./files.html"><code>files</code></a> option was specified, the specified command will be used to retrieve files for <code>git add</code>. For scripts and commands without <a href="configuration/./files.html"><code>files</code></a> option <code>{staged_files}</code> template will be used. All filters (<a href="configuration/./glob.html"><code>glob</code></a>, <a href="configuration/./exclude.html"><code>exclude</code></a>) will be applied if specified.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: npm run lint --fix {staged_files}
      stage_fixed: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="interactive-2"><a class="header" href="#interactive-2"><code>interactive</code></a></h2>
<p><strong>Default: <code>false</code></strong></p>
<blockquote>
<p><strong>Note:</strong> If you want to pass stdin to your command or script but don't need to get the input from CLI, use <a href="configuration/./use_stdin.html"><code>use_stdin</code></a> option instead.</p>
</blockquote>
<p>Whether to use interactive mode. This applies the certain behavior:</p>
<ul>
<li>All <code>interactive</code> commands/scripts are executed after non-interactive. Exception: <a href="configuration/./piped.html"><code>piped</code></a> option is set to <code>true</code>.</li>
<li>When executing, lefthook tries to open /dev/tty (Linux/Unix only) and use it as stdin.</li>
<li>When <a href="configuration/./no_tty.html"><code>no_tty</code></a> option is set, <code>interactive</code> is ignored.</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="use_stdin-2"><a class="header" href="#use_stdin-2"><code>use_stdin</code></a></h2>
<blockquote>
<p><strong>Note:</strong> With many commands or scripts having <code>use_stdin: true</code>, only one will receive the data. The others will have nothing. If you need to pass the data from stdin to every command or script, please, submit a <a href="https://github.com/evilmartians/lefthook/issues/new?assignees=&amp;labels=feature+request&amp;projects=&amp;template=feature_request.md">feature request</a>.</p>
</blockquote>
<p>Pass the stdin from the OS to the command/script.</p>
<p><strong>Example</strong></p>
<p>Use this option for the <code>pre-push</code> hook when you have a script that does <code>while read ...</code>. Without this option lefthook will hang: lefthook uses <a href="https://github.com/creack/pty">pseudo TTY</a> by default, and it doesn't close stdin when all data is read.</p>
<pre><code class="language-bash"># .lefthook/pre-push/do-the-magic.sh

remote="$1"
url="$2"

while read local_ref local_oid remote_ref remote_oid; do
  # ...
done
</code></pre>
<pre><code class="language-yml"># lefthook.yml
pre-push:
  scripts:
    "do-the-magic.sh":
      runner: bash
      use_stdin: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="priority-1"><a class="header" href="#priority-1"><code>priority</code></a></h2>
<p><strong>Default: <code>0</code></strong></p>
<blockquote>
<p><strong>Note:</strong> This option makes sense only when <code>parallel: false</code> or <code>piped: true</code> is set.</p>
<p>Value <code>0</code> is considered an <code>+Infinity</code>, so commands or scripts with <code>priority: 0</code> or without this setting will be run at the very end.</p>
</blockquote>
<p>Set priority from 1 to +Infinity. This option can be used to configure the order of the sequential steps.</p>
<p><strong>Example</strong></p>
<pre><code class="language-yml"># lefthook.yml

post-checkout:
  piped: true
  commands:
    db-create:
      priority: 1
      run: rails db:create
    db-migrate:
      priority: 2
      run: rails db:migrate
    db-seed:
      priority: 3
      run: rails db:seed

  scripts:
    "check-spelling.sh":
      runner: bash
      priority: 1
    "check-grammar.rb":
      runner: ruby
      priority: 2
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="examples-1"><a class="header" href="#examples-1">Examples</a></h1>
<ul>
<li><a href="examples/./lefthook-local.html">Use lefthook-local.yml with extensions and overrides</a></li>
<li><a href="examples/./stage_fixed.html">Auto stage changed files</a></li>
<li><a href="examples/./filters.html">Filter files</a></li>
<li><a href="examples/./skip.html">Skip or run on condition</a></li>
<li><a href="examples/./remotes.html">Use remote config</a></li>
<li><a href="examples/./commitlint.html">Use commitlint</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h2 id="lefthook-localyml"><a class="header" href="#lefthook-localyml">lefthook-local.yml</a></h2>
<p><code>lefthook-local.yml</code> overrides and extends the configuration of your main <code>lefthook.yml</code> (or <code>lefthook.toml</code>, <a href="examples/../configuration">etc.</a>) file.</p>
<blockquote>
<p><strong>Tip:</strong> You can put <code>lefthook-local.yml</code> into your <code>~/.gitignore</code>, so in every project you can have your local-only overrides.</p>
</blockquote>
<p><em>Special feature</em> of <code>lefthook-local.yml</code>: you can wrap the commands using <code>{cmd}</code> template.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: bundle exec rubocop {staged_files}
      glob: "*.rb"
    check-links:
      run: lychee {staged_files}
</code></pre>
<pre><code class="language-yml"># lefthook-local.yml

pre-commit:
  parallel: true # run all commands concurrently
  commands:
    lint:
      run: docker-compose run backend {cmd} # wrap the original command with docker-compose
    check-links:
      skip: true # skip checking links

# Add another hook
post-merge:
  files: "git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD"
  commands:
    dependencies:
      glob: "Gemfile*"
      run: docker-compose run backend bundle install
</code></pre>
<hr />
<pre><code class="language-yml"># The resulting config would look like this

pre-commit:
  parallel: true
  commands:
    lint:
      run: docker-compose run backend bundle exec rubocop {staged_files}
      glob: "*.rb"
    check-links:
      run: lychee {staged_files}
      skip: true

post-merge:
  files: "git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD"
  commands:
    dependencies:
      glob: "Gemfile*"
      run: docker-compose run backend bundle install
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="stage-fixed-files"><a class="header" href="#stage-fixed-files">Stage fixed files</a></h2>
<blockquote>
<p>Works only for <code>pre-commit</code> Git hook</p>
</blockquote>
<p>Sometimes your linter fixes the changes and you usually want to commit them automatically. To enable auto-staging of the fixed files use <a href="examples/../configuration/stage_fixed.html"><code>stage_fixed</code></a> option.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint {staged_files} --fix
      stage_fixed: true
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="filters"><a class="header" href="#filters">Filters</a></h2>
<p>Files passed to your hooks can be filtered with the following options</p>
<ul>
<li><a href="examples/../configuration/glob.html"><code>glob</code></a></li>
<li><a href="examples/../configuration/exclude.html"><code>exclude</code></a></li>
<li><a href="examples/../configuration/file_types.html"><code>file_types</code></a></li>
<li><a href="examples/../configuration/root.html"><code>root</code></a></li>
</ul>
<p>In this example all <strong>staged files</strong> will pass through these filters.</p>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  commands:
    lint:
      run: yarn lint {staged_files} --fix
      glob: "*.{js,ts}"
      root: frontend
      exclude:
        - *.config.js
        - *.config.ts
      file_types:
        - not executable
</code></pre>
<p>Imagine you've staged the following files</p>
<pre><code class="language-bash">backend/asset.js
frontend/src/index.ts
frontend/bin/cli.js # &lt;- executable
frontend/eslint.config.js
frontend/README.md
</code></pre>
<p>After all filters applied the <code>lint</code> command will execute the following:</p>
<pre><code class="language-bash">yarn lint frontend/src/index.ts --fix
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="skip-or-run-on-condition"><a class="header" href="#skip-or-run-on-condition">Skip or run on condition</a></h2>
<p>Here are two hooks.</p>
<p><code>pre-commit</code> hook will only be executed when you're committing something on a branch starting with <code>def/</code> prefix.</p>
<p>In <code>pre-push</code> hook:</p>
<ul>
<li><code>test</code> command will be skipped if <code>NO_TEST</code> env variable is set to <code>1</code></li>
<li><code>lint</code> command will only be executed if you're pushing the <code>main</code> branch</li>
</ul>
<pre><code class="language-yml"># lefthook.yml

pre-commit:
  only:
    - ref: dev/*
  commands:
    lint:
      run: yarn lint {staged_files} --fix
      glob: "*.{ts,js}"
    test:
      run: yarn test

pre-push:
  commands:
    test:
      run: yarn test
      skip:
        - run: test "$NO_TEST" -eq 1
    lint:
      run: yarn lint
      only:
        - ref: main
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="remotes-1"><a class="header" href="#remotes-1">Remotes</a></h2>
<p>Use configurations from other Git repositories via <code>remotes</code> feature.</p>
<p>Lefthook will automatically download the remote config files and merge them into existing configuration.</p>
<pre><code class="language-yml">remotes:
  - git_url: https://github.com/evilmartians/lefthook
    configs:
      - examples/remote/ping.yml
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h2 id="commitlint-and-commitzen"><a class="header" href="#commitlint-and-commitzen">Commitlint and commitzen</a></h2>
<p>Use lefthook to generate commit messages using commitzen and validate them with commitlint.</p>
<h2 id="install-dependencies"><a class="header" href="#install-dependencies">Install dependencies</a></h2>
<pre><code class="language-bash">yarn add -D @commitlint/cli @commitlint/config-conventional

# For commitzen
yarn add -D commitizen cz-conventional-changelog
</code></pre>
<h2 id="configure"><a class="header" href="#configure">Configure</a></h2>
<p>Setup <code>commitlint.config.js</code>. Conventional configuration:</p>
<pre><code class="language-js">// commitlint.config.js

module.exports = {extends: ['@commitlint/config-conventional']};
</code></pre>
<p>If you are using commitzen, make sure to add this in <code>package.json</code>:</p>
<pre><code class="language-json">"config": {
  "commitizen": {
    "path": "./node_modules/cz-conventional-changelog"
  }
}
</code></pre>
<p>Configure lefthook:</p>
<pre><code class="language-yml"># lefthook.yml

# Build commit messages
prepare-commit-msg:
  commands:
    commitzen:
      interactive: true
      run: yarn run cz --hook # Or npx cz --hook
      env:
        LEFTHOOK: 0

# Validate commit messages
commit-msg:
  commands:
    "lint commit message":
      run: yarn run commitlint --edit {1}
</code></pre>
<h2 id="test-it"><a class="header" href="#test-it">Test it</a></h2>
<pre><code class="language-bash"># You can type it without message, if you are using commitzen
git commit

# Or provide a commit message is using only commitlint
git commit -am 'fix: typo'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributors"><a class="header" href="#contributors">Contributors</a></h1>
<ul>
<li><a href="https://github.com/Arkweid">Arkweid</a></li>
<li><a href="https://github.com/Envek">Envek</a></li>
<li><a href="https://github.com/mrexox">mrexox</a></li>
<li><a href="https://github.com/skryukov">skryukov</a></li>
<li><a href="https://github.com/scop">scop</a></li>
<li><a href="https://github.com/hyperupcall">hyperupcall</a></li>
<li><a href="https://github.com/MartijnCuppens">MartijnCuppens</a></li>
<li><a href="https://github.com/palkan">palkan</a></li>
<li><a href="https://github.com/markovichecha">markovichecha</a></li>
<li><a href="https://github.com/technicalpickles">technicalpickles</a></li>
<li><a href="https://github.com/aminya">aminya</a></li>
<li><a href="https://github.com/prog-supdex">prog-supdex</a></li>
<li><a href="https://github.com/HellSquirrel">HellSquirrel</a></li>
<li><a href="https://github.com/Evilweed">Evilweed</a></li>
<li><a href="https://github.com/PikachuEXE">PikachuEXE</a></li>
<li><a href="https://github.com/jsmestad">jsmestad</a></li>
<li><a href="https://github.com/DmitryTsepelev">DmitryTsepelev</a></li>
<li><a href="https://github.com/pmirecki">pmirecki</a></li>
<li><a href="https://github.com/0legovich">0legovich</a></li>
<li><a href="https://github.com/zachahn">zachahn</a></li>
<li><a href="https://github.com/sitiom">sitiom</a></li>
<li><a href="https://github.com/spearmootz">spearmootz</a></li>
<li><a href="https://github.com/pwinckles">pwinckles</a></li>
<li><a href="https://github.com/pablobirukov">pablobirukov</a></li>
<li><a href="https://github.com/nihalgonsalves">nihalgonsalves</a></li>
<li><a href="https://github.com/nesk">nesk</a></li>
<li><a href="https://github.com/jaydorsey">jaydorsey</a></li>
<li><a href="https://github.com/fantua">fantua</a></li>
<li><a href="https://github.com/orsinium">orsinium</a></li>
<li><a href="https://github.com/fabn">fabn</a></li>
</ul>
<p>If you feel you‚Äôre missing from this list, feel free to add yourself in a PR.</p>
<!---
curl https://api.github.com/repos/evilmartians/lefthook/contributors | jq '.[] | "[" + .login + "]" + "(" + .url + ")"'
-->

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
